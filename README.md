### 1.èƒŒæ™¯æ„ä¹‰

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

å°é¼ ä½œä¸ºä¸€ç§é‡è¦çš„å®éªŒåŠ¨ç‰©ï¼Œå¹¿æ³›åº”ç”¨äºç”Ÿç‰©åŒ»å­¦ç ”ç©¶ã€è¯ç‰©å¼€å‘å’Œè¡Œä¸ºç§‘å­¦ç­‰é¢†åŸŸã€‚é€šè¿‡å¯¹å°é¼ è¡Œä¸ºçš„æ·±å…¥åˆ†æï¼Œç ”ç©¶äººå‘˜èƒ½å¤Ÿè·å¾—å…³äºç¥ç»ç”Ÿç‰©å­¦ã€å¿ƒç†å­¦å’Œè¯ç†å­¦ç­‰æ–¹é¢çš„é‡è¦ä¿¡æ¯ã€‚ä¼ ç»Ÿçš„è¡Œä¸ºè§‚å¯Ÿæ–¹æ³•å¾€å¾€ä¾èµ–äºäººå·¥è®°å½•ï¼Œä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè€Œä¸”å®¹æ˜“å—åˆ°è§‚å¯Ÿè€…ä¸»è§‚å› ç´ çš„å½±å“ã€‚å› æ­¤ï¼Œå¼€å‘ä¸€ç§é«˜æ•ˆã€å‡†ç¡®çš„å°é¼ è¡Œä¸ºè¯†åˆ«ç³»ç»Ÿæ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚

è¿‘å¹´æ¥ï¼Œè®¡ç®—æœºè§†è§‰æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ä¸ºåŠ¨ç‰©è¡Œä¸ºè¯†åˆ«æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆã€‚YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶å®æ—¶æ€§å’Œé«˜ç²¾åº¦çš„ç‰¹ç‚¹ï¼Œæˆä¸ºç›®æ ‡æ£€æµ‹é¢†åŸŸçš„çƒ­é—¨é€‰æ‹©ã€‚YOLOv11ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†æ¨¡å‹çš„æ€§èƒ½ï¼Œèƒ½å¤Ÿåœ¨å¤æ‚ç¯å¢ƒä¸­å®ç°æ›´ä¸ºç²¾ç¡®çš„è¡Œä¸ºè¯†åˆ«ã€‚é€šè¿‡å¯¹å°é¼ è¡Œä¸ºçš„è‡ªåŠ¨åŒ–è¯†åˆ«ï¼Œä¸ä»…å¯ä»¥æé«˜å®éªŒæ•°æ®çš„å¯é æ€§ï¼Œè¿˜èƒ½ä¸ºè¡Œä¸ºå­¦ç ”ç©¶æä¾›æ›´ä¸ºä¸°å¯Œçš„å®šé‡åˆ†æã€‚

æœ¬ç ”ç©¶æ—¨åœ¨åŸºäºæ”¹è¿›çš„YOLOv11æ¨¡å‹ï¼Œæ„å»ºä¸€ä¸ªå°é¼ è¡Œä¸ºè¯†åˆ«ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿå°†åˆ©ç”¨ä¸€ä¸ªåŒ…å«2200å¼ å›¾åƒçš„æ•°æ®é›†ï¼Œæ¶µç›–äº†å°é¼ çš„åç§å…¸å‹è¡Œä¸ºï¼ŒåŒ…æ‹¬å‰çˆªèˆ”èˆã€å‰çˆªæŠ¬èµ·ã€æ¢³ç†ã€åçˆªèˆ”èˆã€åçˆªæŠ¬èµ·ã€åŸåœ°ã€è·³è·ƒã€ç›´ç«‹ã€ä¼¸å±•å’Œè½¬èº«ç­‰ã€‚è¿™äº›è¡Œä¸ºçš„å¤šæ ·æ€§ä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†ä¸°å¯Œçš„æ ·æœ¬ï¼Œæœ‰åŠ©äºæé«˜è¯†åˆ«çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚

é€šè¿‡æœ¬é¡¹ç›®çš„å®æ–½ï¼ŒæœŸæœ›èƒ½å¤Ÿä¸ºå°é¼ è¡Œä¸ºç ”ç©¶æä¾›ä¸€ç§é«˜æ•ˆã€è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œæ¨åŠ¨ç›¸å…³é¢†åŸŸçš„ç ”ç©¶è¿›å±•ã€‚åŒæ—¶ï¼ŒåŸºäºYOLOv11çš„æ”¹è¿›æ¨¡å‹ä¹Ÿå°†ä¸ºå…¶ä»–åŠ¨ç‰©è¡Œä¸ºè¯†åˆ«çš„ç ”ç©¶æä¾›å€Ÿé‰´ï¼Œä¿ƒè¿›è®¡ç®—æœºè§†è§‰æŠ€æœ¯åœ¨ç”Ÿç‰©åŒ»å­¦é¢†åŸŸçš„åº”ç”¨ä¸å‘å±•ã€‚

### 2.è§†é¢‘æ•ˆæœ

[2.1 è§†é¢‘æ•ˆæœ]()

### 3.å›¾ç‰‡æ•ˆæœ

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### [é¡¹ç›®æ¶‰åŠçš„æºç æ•°æ®æ¥æºé“¾æ¥](https://kdocs.cn/l/cszuIiCKVNis)**

æ³¨æ„ï¼šæœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,ç”±äºç‰ˆæœ¬æŒç»­æ›´æ–°,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,è¯·æŒ‰ç…§6.è®­ç»ƒæ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°ä¸Šå›¾æ¼”ç¤ºçš„æ•ˆæœã€‚

### 4.æ•°æ®é›†ä¿¡æ¯

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†ç±»åˆ«æ•°ï¼†ç±»åˆ«å

nc: 10
names: ['Frontpaw licking', 'Frontpaw lifting', 'Grooming', 'Hindpaw licking', 'Hindpaw lifting', 'In place', 'Jumping', 'Rearing', 'Stretching', 'Turning']



è¯¥é¡¹ç›®ä¸ºã€å›¾åƒåˆ†å‰²ã€‘æ•°æ®é›†ï¼Œè¯·åœ¨ã€è®­ç»ƒæ•™ç¨‹å’ŒWebç«¯åŠ è½½æ¨¡å‹æ•™ç¨‹ï¼ˆç¬¬ä¸‰æ­¥ï¼‰ã€‘è¿™ä¸€æ­¥çš„æ—¶å€™æŒ‰ç…§ã€å›¾åƒåˆ†å‰²ã€‘éƒ¨åˆ†çš„æ•™ç¨‹æ¥è®­ç»ƒ

##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æœ¬é¡¹ç›®æ—¨åœ¨é€šè¿‡æ”¹è¿›YOLOv11æ¨¡å‹ï¼Œæå‡å°é¼ è¡Œä¸ºè¯†åˆ«ç³»ç»Ÿçš„å‡†ç¡®æ€§ä¸æ•ˆç‡ã€‚ä¸ºå®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†â€œHotplate_behavior_annotationsâ€æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†ä¸“æ³¨äºå°é¼ åœ¨çƒ­æ¿å®éªŒä¸­çš„å¤šç§è¡Œä¸ºè¡¨ç°ï¼Œæ¶µç›–äº†ä¸°å¯Œçš„è¡Œä¸ºç±»åˆ«ï¼Œé€‚åˆç”¨äºè®­ç»ƒå’ŒéªŒè¯æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚æ•°æ®é›†ä¸­åŒ…å«10ä¸ªä¸»è¦çš„è¡Œä¸ºç±»åˆ«ï¼Œå…·ä½“åŒ…æ‹¬ï¼šå‰çˆªèˆ”èˆã€å‰çˆªæŠ¬èµ·ã€æ¢³ç†ã€åçˆªèˆ”èˆã€åçˆªæŠ¬èµ·ã€åŸåœ°æ´»åŠ¨ã€è·³è·ƒã€ç«–ç«‹ã€ä¼¸å±•ä»¥åŠè½¬èº«ã€‚è¿™äº›è¡Œä¸ºç±»åˆ«ä¸ä»…å…·æœ‰æ˜¾è‘—çš„ç”Ÿç‰©å­¦æ„ä¹‰ï¼Œè¿˜èƒ½ä¸ºç ”ç©¶å°é¼ çš„ç–¼ç—›ååº”ã€æ´»åŠ¨æ°´å¹³åŠå…¶ä»–ç”Ÿç†è¡Œä¸ºæä¾›é‡è¦çš„å‚è€ƒã€‚

åœ¨æ•°æ®é›†çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰è¡Œä¸ºå‡ç»è¿‡ç²¾ç¡®æ ‡æ³¨ï¼Œç¡®ä¿æ¯ä¸ªæ ·æœ¬çš„è¡Œä¸ºç‰¹å¾æ¸…æ™°å¯è¾¨ã€‚è¿™ä¸€è¿‡ç¨‹æ¶‰åŠåˆ°å¯¹å°é¼ åœ¨çƒ­æ¿ä¸Šè¡Œä¸ºçš„ç»†è‡´è§‚å¯Ÿä¸è®°å½•ï¼Œç¡®ä¿æ•°æ®çš„çœŸå®æ€§å’Œå¯é æ€§ã€‚é€šè¿‡å¯¹è¿™äº›è¡Œä¸ºçš„æ·±å…¥åˆ†æï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å°é¼ åœ¨ä¸åŒç¯å¢ƒåˆºæ¿€ä¸‹çš„ååº”æœºåˆ¶ï¼Œä¸ºç›¸å…³ç”Ÿç‰©åŒ»å­¦ç ”ç©¶æä¾›åšå®çš„æ•°æ®åŸºç¡€ã€‚

æ­¤å¤–ï¼Œæ•°æ®é›†çš„å¤šæ ·æ€§å’Œä¸°å¯Œæ€§ä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†å¹¿æ³›çš„æ ·æœ¬æ”¯æŒï¼Œä½¿å¾—YOLOv11åœ¨è¯†åˆ«å°é¼ è¡Œä¸ºæ—¶èƒ½å¤Ÿå…·å¤‡æ›´å¼ºçš„æ³›åŒ–èƒ½åŠ›ã€‚é€šè¿‡ä½¿ç”¨è¿™ä¸€æ•°æ®é›†ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåœ¨å°é¼ è¡Œä¸ºè¯†åˆ«é¢†åŸŸå–å¾—çªç ´æ€§è¿›å±•ï¼Œæ¨åŠ¨ç›¸å…³ç ”ç©¶çš„æ·±å…¥å‘å±•ã€‚æ•´ä½“è€Œè¨€ï¼Œâ€œHotplate_behavior_annotationsâ€æ•°æ®é›†ä¸ä»…ä¸ºæœ¬é¡¹ç›®æä¾›äº†å¿…è¦çš„è®­ç»ƒæ•°æ®ï¼Œä¹Ÿä¸ºæœªæ¥åœ¨å°é¼ è¡Œä¸ºå­¦åŠå…¶ç›¸å…³é¢†åŸŸçš„ç ”ç©¶å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 æ‰€éœ€è½¯ä»¶PyCharmå’ŒAnacondaå®‰è£…æ•™ç¨‹ï¼ˆç¬¬ä¸€æ­¥ï¼‰](https://www.bilibili.com/video/BV1BoC1YCEKi/?spm_id_from=333.999.0.0&vd_source=bc9aec86d164b67a7004b996143742dc)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹ï¼ˆç¬¬äºŒæ­¥ï¼‰](https://www.bilibili.com/video/BV1ZoC1YCEBw?spm_id_from=333.788.videopod.sections&vd_source=bc9aec86d164b67a7004b996143742dc)

### 6.æ”¹è¿›YOLOv11è®­ç»ƒæ•™ç¨‹å’ŒWeb_UIå‰ç«¯åŠ è½½æ¨¡å‹æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[6.1 æ”¹è¿›YOLOv11è®­ç»ƒæ•™ç¨‹å’ŒWeb_UIå‰ç«¯åŠ è½½æ¨¡å‹æ•™ç¨‹ï¼ˆç¬¬ä¸‰æ­¥ï¼‰](https://www.bilibili.com/video/BV1BoC1YCEhR?spm_id_from=333.788.videopod.sections&vd_source=bc9aec86d164b67a7004b996143742dc)


æŒ‰ç…§ä¸Šé¢çš„è®­ç»ƒè§†é¢‘æ•™ç¨‹é“¾æ¥åŠ è½½é¡¹ç›®æä¾›çš„æ•°æ®é›†ï¼Œè¿è¡Œtrain.pyå³å¯å¼€å§‹è®­ç»ƒ
ï»¿


     Epoch   gpu_mem       box       obj       cls    labels  img_size
     1/200     20.8G   0.01576   0.01955  0.007536        22      1280: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 849/849 [14:42<00:00,  1.04s/it]
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 213/213 [01:14<00:00,  2.87it/s]
                 all       3395      17314      0.994      0.957      0.0957      0.0843

     Epoch   gpu_mem       box       obj       cls    labels  img_size
     2/200     20.8G   0.01578   0.01923  0.007006        22      1280: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 849/849 [14:44<00:00,  1.04s/it]
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 213/213 [01:12<00:00,  2.95it/s]
                 all       3395      17314      0.996      0.956      0.0957      0.0845

     Epoch   gpu_mem       box       obj       cls    labels  img_size
     3/200     20.8G   0.01561    0.0191  0.006895        27      1280: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 849/849 [10:56<00:00,  1.29it/s]
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 187/213 [00:52<00:00,  4.04it/s]
                 all       3395      17314      0.996      0.957      0.0957      0.0845




###### [é¡¹ç›®æ•°æ®é›†ä¸‹è½½é“¾æ¥](https://kdocs.cn/l/cszuIiCKVNis)

### 7.åŸå§‹YOLOv11ç®—æ³•è®²è§£

YOLOv11æ˜¯Ultralyticsæ¨å‡ºçš„YOLOç³»åˆ—æœ€æ–°ç‰ˆæœ¬ï¼Œä¸“ä¸ºå®ç°å°–ç«¯çš„ç‰©ä½“æ£€æµ‹è€Œè®¾è®¡ã€‚å…¶æ¶æ„å’Œè®­ç»ƒæ–¹æ³•ä¸Šè¿›è¡Œäº†é‡å¤§æ”¹è¿›ï¼Œä½¿ä¹‹ä¸ä»…å…·å¤‡å“è¶Šçš„å‡†ç¡®æ€§å’Œå¤„ç†é€Ÿåº¦ï¼Œè¿˜åœ¨è®¡ç®—æ•ˆç‡ä¸Šå®ç°äº†ä¸€åœºé©å‘½ã€‚å¾—ç›Šäºå…¶æ”¹è¿›çš„ä¸»å¹²å’Œé¢ˆéƒ¨æ¶æ„ï¼ŒYOLOv11åœ¨ç‰¹å¾æå–å’Œå¤„ç†å¤æ‚ä»»åŠ¡æ—¶è¡¨ç°æ›´åŠ å‡ºè‰²ã€‚åœ¨2024å¹´9æœˆ27æ—¥ï¼ŒUltralyticsé€šè¿‡é•¿è¾¾ä¹å°æ—¶çš„åœ¨çº¿ç›´æ’­å‘å¸ƒè¿™ä¸€æ–°ä½œï¼Œå±•ç¤ºäº†å…¶åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„é©æ–°ã€‚

YOLOv11é€šè¿‡ç²¾ç»†çš„æ¶æ„è®¾è®¡å’Œä¼˜åŒ–è®­ç»ƒæµç¨‹ï¼Œåœ¨ä¿æŒé«˜ç²¾åº¦çš„åŒæ—¶ï¼Œç¼©å‡äº†å‚æ•°é‡ï¼Œä¸YOLOv8mç›¸æ¯”å‡å°‘äº†22%çš„å‚æ•°ï¼Œä½¿å…¶åœ¨COCOæ•°æ®é›†ä¸Šçš„å¹³å‡å‡†ç¡®åº¦ï¼ˆmAPï¼‰æœ‰æ‰€æå‡ã€‚è¿™ç§æ•ˆç‡çš„æé«˜ä½¿YOLOv11éå¸¸é€‚åˆéƒ¨ç½²åœ¨å„ç§ç¡¬ä»¶ç¯å¢ƒä¸­ï¼ŒåŒ…æ‹¬è¾¹ç¼˜è®¾å¤‡ã€äº‘è®¡ç®—å¹³å°ä»¥åŠæ”¯æŒNVIDIA GPUçš„ç³»ç»Ÿï¼Œç¡®ä¿åœ¨çµæ´»æ€§ä¸Šçš„ä¼˜åŠ¿ã€‚

è¯¥æ¨¡å‹æ”¯æŒå¹¿æ³›çš„ä»»åŠ¡ï¼Œä»å¯¹è±¡æ£€æµ‹ã€å®ä¾‹åˆ†å‰²åˆ°å›¾åƒåˆ†ç±»ã€å§¿æ€ä¼°è®¡å’Œå®šå‘å¯¹è±¡æ£€æµ‹ï¼ˆOBBï¼‰ï¼Œå‡ ä¹è¦†ç›–äº†è®¡ç®—æœºè§†è§‰çš„æ‰€æœ‰ä¸»è¦æŒ‘æˆ˜ã€‚å…¶åˆ›æ–°çš„C3k2å’ŒC2PSAæ¨¡å—æå‡äº†ç½‘ç»œæ·±åº¦å’Œæ³¨æ„åŠ›æœºåˆ¶çš„åº”ç”¨ï¼Œæé«˜äº†ç‰¹å¾æå–çš„æ•ˆç‡å’Œæ•ˆæœã€‚åŒæ—¶ï¼ŒYOLOv11çš„æ”¹è¿›ç½‘ç»œç»“æ„ä¹Ÿä½¿ä¹‹åœ¨å¤æ‚è§†è§‰ä»»åŠ¡ä¸Šå¾—ä»¥ä»å®¹åº”å¯¹ï¼Œæˆä¸ºå„ç±»è®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„å¤šåŠŸèƒ½é€‰æ‹©ã€‚è¿™äº›ç‰¹æ€§ä»¤YOLOv11åœ¨å®æ–½å®æ—¶ç‰©ä½“æ£€æµ‹çš„å„ä¸ªé¢†åŸŸä¸­è¡¨ç°å‡ºä¼—ã€‚
* * *

2024å¹´9æœˆ27æ—¥ï¼ŒUltralyticsåœ¨çº¿ç›´æ’­é•¿è¾¾ä¹å°æ—¶ï¼Œä¸ºYOLO11å¬å¼€â€œå‘å¸ƒä¼šâ€

YOLO11 æ˜¯ Ultralytics YOLO ç³»åˆ—å®æ—¶ç‰©ä½“æ£€æµ‹å™¨çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå®ƒä»¥å°–ç«¯çš„å‡†ç¡®æ€§ã€é€Ÿåº¦å’Œæ•ˆç‡é‡æ–°å®šä¹‰äº†å¯èƒ½æ€§ã€‚åœ¨ä¹‹å‰ YOLO
ç‰ˆæœ¬çš„æ˜¾è‘—è¿›æ­¥çš„åŸºç¡€ä¸Šï¼ŒYOLO11 åœ¨æ¶æ„å’Œè®­ç»ƒæ–¹æ³•æ–¹é¢è¿›è¡Œäº†é‡å¤§æ”¹è¿›ï¼Œä½¿å…¶æˆä¸ºå„ç§è®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„å¤šåŠŸèƒ½é€‰æ‹©ã€‚

![](https://i-blog.csdnimg.cn/direct/a4e1a178833746249720ccee1c82a58b.png)

##### YOLO11ä¸»è¦ç‰¹ç‚¹ï¼š

  * å¢å¼ºçš„ç‰¹å¾æå–ï¼šYOLO11 é‡‡ç”¨äº†æ”¹è¿›çš„ä¸»å¹²å’Œé¢ˆéƒ¨æ¶æ„ï¼Œå¢å¼ºäº†ç‰¹å¾æå–èƒ½åŠ›ï¼Œå¯å®ç°æ›´ç²¾ç¡®çš„å¯¹è±¡æ£€æµ‹å’Œå¤æ‚ä»»åŠ¡æ€§èƒ½ã€‚
  * é’ˆå¯¹æ•ˆç‡å’Œé€Ÿåº¦è¿›è¡Œäº†ä¼˜åŒ–ï¼šYOLO11 å¼•å…¥äº†å®Œå–„çš„æ¶æ„è®¾è®¡å’Œä¼˜åŒ–çš„è®­ç»ƒæµç¨‹ï¼Œå¯æä¾›æ›´å¿«çš„å¤„ç†é€Ÿåº¦ï¼Œå¹¶åœ¨å‡†ç¡®åº¦å’Œæ€§èƒ½ä¹‹é—´ä¿æŒæœ€ä½³å¹³è¡¡ã€‚
  * æ›´å°‘çš„å‚æ•°ï¼Œæ›´é«˜çš„å‡†ç¡®åº¦ï¼šå€ŸåŠ©æ¨¡å‹è®¾è®¡çš„è¿›æ­¥ï¼ŒYOLO11m åœ¨ COCO æ•°æ®é›†ä¸Šå®ç°äº†æ›´é«˜çš„å¹³å‡å‡†ç¡®åº¦ (mAP)ï¼ŒåŒæ—¶ä½¿ç”¨çš„å‚æ•°æ¯” YOLOv8m å°‘ 22%ï¼Œä»è€Œæé«˜äº†è®¡ç®—æ•ˆç‡ï¼ŒåŒæ—¶åˆä¸å½±å“å‡†ç¡®åº¦ã€‚
  * è·¨ç¯å¢ƒçš„é€‚åº”æ€§ï¼šYOLO11 å¯ä»¥æ— ç¼éƒ¨ç½²åœ¨å„ç§ç¯å¢ƒä¸­ï¼ŒåŒ…æ‹¬è¾¹ç¼˜è®¾å¤‡ã€äº‘å¹³å°å’Œæ”¯æŒ NVIDIA GPU çš„ç³»ç»Ÿï¼Œä»è€Œç¡®ä¿æœ€å¤§çš„çµæ´»æ€§ã€‚
  * æ”¯æŒçš„ä»»åŠ¡èŒƒå›´å¹¿æ³›ï¼šæ— è®ºæ˜¯å¯¹è±¡æ£€æµ‹ã€å®ä¾‹åˆ†å‰²ã€å›¾åƒåˆ†ç±»ã€å§¿åŠ¿ä¼°è®¡è¿˜æ˜¯å®šå‘å¯¹è±¡æ£€æµ‹ (OBB)ï¼ŒYOLO11 éƒ½æ—¨åœ¨æ»¡è¶³å„ç§è®¡ç®—æœºè§†è§‰æŒ‘æˆ˜ã€‚

##### æ”¯æŒçš„ä»»åŠ¡å’Œæ¨¡å¼

YOLO11 ä»¥ YOLOv8 ä¸­å¼•å…¥çš„å¤šåŠŸèƒ½æ¨¡å‹ç³»åˆ—ä¸ºåŸºç¡€ï¼Œä¸ºå„ç§è®¡ç®—æœºè§†è§‰ä»»åŠ¡æä¾›å¢å¼ºçš„æ”¯æŒï¼š

Model| Filenames| Task| Inference| Validation| Training| Export  
---|---|---|---|---|---|---  
YOLO11| yolol11n.pt, yolol11s.pt, yolol11m.pt, yolol11x.pt| Detection| âœ…| âœ…|
âœ…| âœ…  
YOLO11-seg| yolol11n-seg.pt, yolol11s-seg.pt, yolol11m-seg.pt,
yolol11x-seg.pt| Instance Segmentation| âœ…| âœ…| âœ…| âœ…  
YOLO11-pose| yolol11n-pose.pt, yolol11s-pose.pt, yolol11m-pose.pt,
yolol11x-pose.pt| Pose/Keypoints| âœ…| âœ…| âœ…| âœ…  
YOLO11-obb| yolol11n-obb.pt, yolol11s-obb.pt, yolol11m-obb.pt,
yolol11x-obb.pt| Oriented Detection| âœ…| âœ…| âœ…| âœ…  
YOLO11-cls| yolol11n-cls.pt, yolol11s-cls.pt, yolol11m-cls.pt,
yolol11x-cls.pt| Classification| âœ…| âœ…| âœ…| âœ…  
  
##### ç®€å•çš„ YOLO11 è®­ç»ƒå’Œæ¨ç†ç¤ºä¾‹

ä»¥ä¸‹ç¤ºä¾‹é€‚ç”¨äºç”¨äºå¯¹è±¡æ£€æµ‹çš„ YOLO11 Detect æ¨¡å‹ã€‚

    
    
    from ultralytics import YOLO
    
    # Load a model
    model = YOLO("yolo11n.pt")
    
    # Train the model
    train_results = model.train(
        data="coco8.yaml",  # path to dataset YAML
        epochs=100,  # number of training epochs
        imgsz=640,  # training image size
        device="cpu",  # device to run on, i.e. device=0 or device=0,1,2,3 or device=cpu
    )
    
    # Evaluate model performance on the validation set
    metrics = model.val()
    
    # Perform object detection on an image
    results = model("path/to/image.jpg")
    results[0].show()
    
    # Export the model to ONNX format
    path = model.export(format="onnx")  # return path to exported model

##### æ”¯æŒéƒ¨ç½²äºè¾¹ç¼˜è®¾å¤‡

YOLO11 ä¸“ä¸ºé€‚åº”å„ç§ç¯å¢ƒè€Œè®¾è®¡ï¼ŒåŒ…æ‹¬è¾¹ç¼˜è®¾å¤‡ã€‚å…¶ä¼˜åŒ–çš„æ¶æ„å’Œé«˜æ•ˆçš„å¤„ç†èƒ½åŠ›ä½¿å…¶é€‚åˆéƒ¨ç½²åœ¨è¾¹ç¼˜è®¾å¤‡ã€äº‘å¹³å°å’Œæ”¯æŒ NVIDIA GPU
çš„ç³»ç»Ÿä¸Šã€‚è¿™ç§çµæ´»æ€§ç¡®ä¿ YOLO11 å¯ç”¨äºå„ç§åº”ç”¨ï¼Œä»ç§»åŠ¨è®¾å¤‡ä¸Šçš„å®æ—¶æ£€æµ‹åˆ°äº‘ç¯å¢ƒä¸­çš„å¤æ‚åˆ†å‰²ä»»åŠ¡ã€‚æœ‰å…³éƒ¨ç½²é€‰é¡¹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…å¯¼å‡ºæ–‡æ¡£ã€‚

##### YOLOv11 yamlæ–‡ä»¶

    
    
    # Ultralytics YOLO ğŸš€, AGPL-3.0 license
    # YOLO11 object detection model with P3-P5 outputs. For Usage examples see https://docs.ultralytics.com/tasks/detect
    
    # Parameters
    nc: 80 # number of classes
    scales: # model compound scaling constants, i.e. 'model=yolo11n.yaml' will call yolo11.yaml with scale 'n'
      # [depth, width, max_channels]
      n: [0.50, 0.25, 1024] # summary: 319 layers, 2624080 parameters, 2624064 gradients, 6.6 GFLOPs
      s: [0.50, 0.50, 1024] # summary: 319 layers, 9458752 parameters, 9458736 gradients, 21.7 GFLOPs
      m: [0.50, 1.00, 512] # summary: 409 layers, 20114688 parameters, 20114672 gradients, 68.5 GFLOPs
      l: [1.00, 1.00, 512] # summary: 631 layers, 25372160 parameters, 25372144 gradients, 87.6 GFLOPs
      x: [1.00, 1.50, 512] # summary: 631 layers, 56966176 parameters, 56966160 gradients, 196.0 GFLOPs
    
    # YOLO11n backbone
    backbone:
      # [from, repeats, module, args]
      - [-1, 1, Conv, [64, 3, 2]] # 0-P1/2
      - [-1, 1, Conv, [128, 3, 2]] # 1-P2/4
      - [-1, 2, C3k2, [256, False, 0.25]]
      - [-1, 1, Conv, [256, 3, 2]] # 3-P3/8
      - [-1, 2, C3k2, [512, False, 0.25]]
      - [-1, 1, Conv, [512, 3, 2]] # 5-P4/16
      - [-1, 2, C3k2, [512, True]]
      - [-1, 1, Conv, [1024, 3, 2]] # 7-P5/32
      - [-1, 2, C3k2, [1024, True]]
      - [-1, 1, SPPF, [1024, 5]] # 9
      - [-1, 2, C2PSA, [1024]] # 10
    
    # YOLO11n head
    head:
      - [-1, 1, nn.Upsample, [None, 2, "nearest"]]
      - [[-1, 6], 1, Concat, [1]] # cat backbone P4
      - [-1, 2, C3k2, [512, False]] # 13
    
      - [-1, 1, nn.Upsample, [None, 2, "nearest"]]
      - [[-1, 4], 1, Concat, [1]] # cat backbone P3
      - [-1, 2, C3k2, [256, False]] # 16 (P3/8-small)
    
      - [-1, 1, Conv, [256, 3, 2]]
      - [[-1, 13], 1, Concat, [1]] # cat head P4
      - [-1, 2, C3k2, [512, False]] # 19 (P4/16-medium)
    
      - [-1, 1, Conv, [512, 3, 2]]
      - [[-1, 10], 1, Concat, [1]] # cat head P5
      - [-1, 2, C3k2, [1024, True]] # 22 (P5/32-large)
    
      - [[16, 19, 22], 1, Detect, [nc]] # Detect(P3, P4, P5)
    

**YOLO11å’ŒYOLOv8 yamlæ–‡ä»¶çš„åŒºåˆ«**

![](https://i-blog.csdnimg.cn/direct/a8f3766a015c4ad2a49411ab710b3477.png)

##### æ”¹è¿›æ¨¡å—ä»£ç 

  * C3k2 

    
    
    class C3k2(C2f):
        """Faster Implementation of CSP Bottleneck with 2 convolutions."""
    
        def __init__(self, c1, c2, n=1, c3k=False, e=0.5, g=1, shortcut=True):
            """Initializes the C3k2 module, a faster CSP Bottleneck with 2 convolutions and optional C3k blocks."""
            super().__init__(c1, c2, n, shortcut, g, e)
            self.m = nn.ModuleList(
                C3k(self.c, self.c, 2, shortcut, g) if c3k else Bottleneck(self.c, self.c, shortcut, g) for _ in range(n)
            )

C3k2ï¼Œå®ƒæ˜¯å…·æœ‰ä¸¤ä¸ªå·ç§¯çš„CSPï¼ˆPartial Cross Stageï¼‰ç“¶é¢ˆæ¶æ„çš„æ›´å¿«å®ç°ã€‚

**ç±»ç»§æ‰¿ï¼š**

  * `C3k2`ç»§æ‰¿è‡ªç±»`C2f`ã€‚è¿™è¡¨æ˜`C2f`å¾ˆå¯èƒ½å®ç°äº†ç»è¿‡ä¿®æ”¹çš„åŸºæœ¬CSPç»“æ„ï¼Œè€Œ`C3k2`è¿›ä¸€æ­¥ä¼˜åŒ–æˆ–ä¿®æ”¹äº†æ­¤ç»“æ„ã€‚

**æ„é€ å‡½æ•°ï¼ˆ`__init__`ï¼‰ï¼š**

  * `c1`ï¼šè¾“å…¥é€šé“ã€‚

  * `c2`ï¼šè¾“å‡ºé€šé“ã€‚

  * `n`ï¼šç“¶é¢ˆå±‚æ•°ï¼ˆé»˜è®¤ä¸º1ï¼‰ã€‚

  * `c3k`ï¼šä¸€ä¸ªå¸ƒå°”æ ‡å¿—ï¼Œç¡®å®šæ˜¯å¦ä½¿ç”¨`C3k`å—æˆ–å¸¸è§„`Bottleneck`å—ã€‚

  * `e`ï¼šæ‰©å±•æ¯”ç‡ï¼Œæ§åˆ¶éšè—å±‚çš„å®½åº¦ï¼ˆé»˜è®¤ä¸º0.5ï¼‰ã€‚

  * `g`ï¼šåˆ†ç»„å·ç§¯çš„ç»„å½’ä¸€åŒ–å‚æ•°æˆ–ç»„æ•°ï¼ˆé»˜è®¤å€¼ä¸º 1ï¼‰ã€‚

  * `shortcut`ï¼šä¸€ä¸ªå¸ƒå°”å€¼ï¼Œç”¨äºç¡®å®šæ˜¯å¦åœ¨ç½‘ç»œä¸­åŒ…å«å¿«æ·æ–¹å¼è¿æ¥ï¼ˆé»˜è®¤å€¼ä¸º `True`ï¼‰ã€‚

**åˆå§‹åŒ–ï¼š**

  * `super().__init__(c1, c2, n, short-cut, g, e)` è°ƒç”¨çˆ¶ç±» `C2f` çš„æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æ ‡å‡† CSP ç»„ä»¶ï¼Œå¦‚é€šé“æ•°ã€å¿«æ·æ–¹å¼ã€ç»„ç­‰ã€‚

**æ¨¡å—åˆ—è¡¨ï¼ˆ`self.m`ï¼‰ï¼š**

  * `nn.ModuleList` å­˜å‚¨ `C3k` æˆ– `Bottleneck` æ¨¡å—ï¼Œå…·ä½“å–å†³äº `c3k` çš„å€¼ã€‚

  * å¦‚æœ `c3k` ä¸º `True`ï¼Œå®ƒä¼šåˆå§‹åŒ– `C3k` æ¨¡å—ã€‚`C3k` æ¨¡å—æ¥æ”¶ä»¥ä¸‹å‚æ•°ï¼š

  * `self.c`ï¼šé€šé“æ•°ï¼ˆæºè‡ª `C2f`ï¼‰ã€‚

  * `2`ï¼šè¿™è¡¨ç¤ºåœ¨ `C3k` å—å†…ä½¿ç”¨äº†ä¸¤ä¸ªå·ç§¯å±‚ã€‚

  * `shortcut` å’Œ `g`ï¼šä» `C3k2` æ„é€ å‡½æ•°ä¼ é€’ã€‚

  * å¦‚æœ `c3k` ä¸º `False`ï¼Œåˆ™åˆå§‹åŒ–æ ‡å‡† `Bottleneck` æ¨¡å—ã€‚

`for _ in range(n)` è¡¨ç¤ºå°†åˆ›å»º `n` ä¸ªè¿™æ ·çš„å—ã€‚

**æ€»ç»“ï¼š**

  * `C3k2` å®ç°äº† CSP ç“¶é¢ˆæ¶æ„ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨è‡ªå®šä¹‰ `C3k` å—ï¼ˆå…·æœ‰ä¸¤ä¸ªå·ç§¯ï¼‰æˆ–æ ‡å‡† `Bottleneck` å—ï¼Œå…·ä½“å–å†³äº `c3k` æ ‡å¿—ã€‚

  * C2PSA

    
    
    class C2PSA(nn.Module):
        """
        C2PSA module with attention mechanism for enhanced feature extraction and processing.
    
        This module implements a convolutional block with attention mechanisms to enhance feature extraction and processing
        capabilities. It includes a series of PSABlock modules for self-attention and feed-forward operations.
    
        Attributes:
            c (int): Number of hidden channels.
            cv1 (Conv): 1x1 convolution layer to reduce the number of input channels to 2*c.
            cv2 (Conv): 1x1 convolution layer to reduce the number of output channels to c.
            m (nn.Sequential): Sequential container of PSABlock modules for attention and feed-forward operations.
    
        Methods:
            forward: Performs a forward pass through the C2PSA module, applying attention and feed-forward operations.
    
        Notes:
            This module essentially is the same as PSA module, but refactored to allow stacking more PSABlock modules.
    
        Examples:
            >>> c2psa = C2PSA(c1=256, c2=256, n=3, e=0.5)
            >>> input_tensor = torch.randn(1, 256, 64, 64)
            >>> output_tensor = c2psa(input_tensor)
        """
    
        def __init__(self, c1, c2, n=1, e=0.5):
            """Initializes the C2PSA module with specified input/output channels, number of layers, and expansion ratio."""
            super().__init__()
            assert c1 == c2
            self.c = int(c1 * e)
            self.cv1 = Conv(c1, 2 * self.c, 1, 1)
            self.cv2 = Conv(2 * self.c, c1, 1)
    
            self.m = nn.Sequential(*(PSABlock(self.c, attn_ratio=0.5, num_heads=self.c // 64) for _ in range(n)))
    
        def forward(self, x):
            """Processes the input tensor 'x' through a series of PSA blocks and returns the transformed tensor."""
            a, b = self.cv1(x).split((self.c, self.c), dim=1)
            b = self.m(b)
            return self.cv2(torch.cat((a, b), 1))

`C2PSA` æ¨¡å—æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ç¥ç»ç½‘ç»œå±‚ï¼Œå¸¦æœ‰æ³¨æ„åŠ›æœºåˆ¶ï¼Œç”¨äºå¢å¼ºç‰¹å¾æå–å’Œå¤„ç†ã€‚

**ç±»æ¦‚è¿°**

  * **ç›®çš„ï¼š**

  * `C2PSA` æ¨¡å—å¼•å…¥äº†ä¸€ä¸ªå·ç§¯å—ï¼Œåˆ©ç”¨æ³¨æ„åŠ›æœºåˆ¶æ¥æ”¹è¿›ç‰¹å¾æå–å’Œå¤„ç†ã€‚

  * å®ƒä½¿ç”¨ä¸€ç³»åˆ— `PSABlock` æ¨¡å—ï¼Œè¿™äº›æ¨¡å—å¯èƒ½ä»£è¡¨æŸç§å½¢å¼çš„ä½ç½®è‡ªæ³¨æ„åŠ› (PSA)ï¼Œå¹¶ä¸”è¯¥æ¶æ„æ—¨åœ¨å…è®¸å †å å¤šä¸ª `PSABlock` å±‚ã€‚

**æ„é€ å‡½æ•°ï¼ˆ`__init__`ï¼‰ï¼š**

  * **å‚æ•°ï¼š**

  * `c1`ï¼šè¾“å…¥é€šé“ï¼ˆå¿…é¡»ç­‰äº `c2`ï¼‰ã€‚

  * `c2`ï¼šè¾“å‡ºé€šé“ï¼ˆå¿…é¡»ç­‰äº `c1`ï¼‰ã€‚

  * `n`ï¼šè¦å †å çš„ `PSABlock` æ¨¡å—æ•°é‡ï¼ˆé»˜è®¤å€¼ä¸º 1ï¼‰ã€‚

  * `e`ï¼šæ‰©å±•æ¯”ç‡ï¼Œç”¨äºè®¡ç®—éšè—é€šé“çš„æ•°é‡ï¼ˆé»˜è®¤å€¼ä¸º 0.5ï¼‰ã€‚

  * **å±æ€§ï¼š**

  * `self.c`ï¼šéšè—é€šé“æ•°ï¼Œè®¡ç®—ä¸º `int(c1 * e)`ã€‚

  * `self.cv1`ï¼šä¸€ä¸ª `1x1` å·ç§¯ï¼Œå°†è¾“å…¥é€šé“æ•°ä» `c1` å‡å°‘åˆ° `2 * self.c`ã€‚è¿™ä¸ºå°†è¾“å…¥åˆ†æˆä¸¤éƒ¨åˆ†åšå¥½å‡†å¤‡ã€‚

  * `self.cv2`ï¼šå¦ä¸€ä¸ª `1x1` å·ç§¯ï¼Œå¤„ç†åå°†é€šé“ç»´åº¦æ¢å¤å› `c1`ã€‚

  * `self.m`ï¼šä¸€ç³»åˆ— `PSABlock` æ¨¡å—ã€‚æ¯ä¸ª `PSABlock` æ¥æ”¶ `self.c` é€šé“ï¼Œæ³¨æ„å¤´çš„æ•°é‡ä¸º `self.c // 64`ã€‚æ¯ä¸ªå—åº”ç”¨æ³¨æ„å’Œå‰é¦ˆæ“ä½œã€‚

**å‰å‘æ–¹æ³•ï¼š**

  * **è¾“å…¥ï¼š**

  * `x`ï¼Œè¾“å…¥å¼ é‡ã€‚

  * **æ“ä½œï¼š**

  1. `self.cv1(x)` åº”ç”¨ `1x1` å·ç§¯ï¼Œå°†è¾“å…¥é€šé“å¤§å°ä» `c1` å‡å°åˆ° `2 * self.c`ã€‚

  2. ç”Ÿæˆçš„å¼ é‡æ²¿é€šé“ç»´åº¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œ`a` å’Œ `b`ã€‚

  * `a`ï¼šç¬¬ä¸€ä¸ª `self.c` é€šé“ã€‚

  * `b`ï¼šå‰©ä½™çš„ `self.c` é€šé“ã€‚

  1. `b` é€šè¿‡é¡ºåºå®¹å™¨ `self.m`ï¼Œå®ƒæ˜¯ `PSABlock` æ¨¡å—çš„å †æ ˆã€‚è¿™éƒ¨åˆ†ç»è¿‡åŸºäºæ³¨æ„çš„å¤„ç†ã€‚

  2. å¤„ç†åçš„å¼ é‡ `b` ä¸ `a` è¿æ¥ã€‚

  3. `self.cv2` åº”ç”¨ `1x1` å·ç§¯ï¼Œå°†é€šé“å¤§å°æ¢å¤ä¸º `c1`ã€‚

  * **è¾“å‡ºï¼š**

  * åº”ç”¨æ³¨æ„å’Œå·ç§¯æ“ä½œåçš„å˜æ¢åçš„å¼ é‡ã€‚

**æ€»ç»“ï¼š**

  * **C2PSA** æ˜¯ä¸€ä¸ªå¢å¼ºå‹å·ç§¯æ¨¡å—ï¼Œå®ƒé€šè¿‡å †å çš„ `PSABlock` æ¨¡å—åº”ç”¨ä½ç½®è‡ªæ³¨æ„åŠ›ã€‚å®ƒæ‹†åˆ†è¾“å…¥å¼ é‡ï¼Œå°†æ³¨æ„åŠ›åº”ç”¨äºå…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œç„¶åé‡æ–°ç»„åˆå¹¶é€šè¿‡æœ€ç»ˆå·ç§¯å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚æ­¤ç»“æ„æœ‰åŠ©äºä»è¾“å…¥æ•°æ®ä¸­æå–å¤æ‚ç‰¹å¾ã€‚

##### ç½‘ç»œç»“æ„

![](https://i-blog.csdnimg.cn/direct/761af09befeb45adafae36b679424b26.png)

![](https://i-blog.csdnimg.cn/direct/45e481e295ad458fa7fe4c252fbd5d83.png)




### 8.200+ç§å…¨å¥—æ”¹è¿›YOLOV11åˆ›æ–°ç‚¹åŸç†è®²è§£

#### 8.1 200+ç§å…¨å¥—æ”¹è¿›YOLOV11åˆ›æ–°ç‚¹åŸç†è®²è§£å¤§å…¨

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸å…¨éƒ¨å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„æ”¹è¿›æ¨¡å—å¯¹åº”é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼ˆåˆ›æ–°ç‚¹å‡ä¸ºæ¨¡å—åŒ–æ­å»ºï¼ŒåŸç†é€‚é…YOLOv5~YOLOv11ç­‰å„ç§ç‰ˆæœ¬ï¼‰

[æ”¹è¿›æ¨¡å—æŠ€æœ¯åŸç†åšå®¢ã€Blogã€‘ç½‘å€é“¾æ¥](https://gitee.com/qunmasj/good)

![9.png](9.png)

#### 8.2 ç²¾é€‰éƒ¨åˆ†æ”¹è¿›YOLOV11åˆ›æ–°ç‚¹åŸç†è®²è§£

###### è¿™é‡ŒèŠ‚é€‰éƒ¨åˆ†æ”¹è¿›åˆ›æ–°ç‚¹å±•å¼€åŸç†è®²è§£(å®Œæ•´çš„æ”¹è¿›åŸç†è§ä¸Šå›¾å’Œ[æ”¹è¿›æ¨¡å—æŠ€æœ¯åŸç†åšå®¢é“¾æ¥](https://gitee.com/qunmasj/good)ã€å¦‚æœæ­¤å°èŠ‚çš„å›¾åŠ è½½å¤±è´¥å¯ä»¥é€šè¿‡CSDNæˆ–è€…Githubæœç´¢è¯¥åšå®¢çš„æ ‡é¢˜è®¿é—®åŸå§‹åšå®¢ï¼ŒåŸå§‹åšå®¢å›¾ç‰‡æ˜¾ç¤ºæ­£å¸¸ã€‘
ï»¿
### MS-Blockç®€ä»‹
å®æ—¶ç›®æ ‡æ£€æµ‹ï¼Œä»¥YOLOç³»åˆ—ä¸ºä¾‹ï¼Œå·²åœ¨å·¥ä¸šé¢†åŸŸä¸­æ‰¾åˆ°é‡è¦åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨è¾¹ç¼˜è®¾å¤‡ï¼ˆå¦‚æ— äººæœºå’Œæœºå™¨äººï¼‰ä¸­ã€‚ä¸ä¹‹å‰çš„ç›®æ ‡æ£€æµ‹å™¨ä¸åŒï¼Œå®æ—¶ç›®æ ‡æ£€æµ‹å™¨æ—¨åœ¨åœ¨é€Ÿåº¦å’Œå‡†ç¡®æ€§ä¹‹é—´è¿½æ±‚æœ€ä½³å¹³è¡¡ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæå‡ºäº†å¤§é‡çš„å·¥ä½œï¼šä»ç¬¬ä¸€ä»£DarkNetåˆ°CSPNetï¼Œå†åˆ°æœ€è¿‘çš„æ‰©å±•ELANï¼Œéšç€æ€§èƒ½çš„å¿«é€Ÿå¢é•¿ï¼Œå®æ—¶ç›®æ ‡æ£€æµ‹å™¨çš„æ¶æ„ç»å†äº†å·¨å¤§çš„å˜åŒ–ã€‚

å°½ç®¡æ€§èƒ½ä»¤äººå°è±¡æ·±åˆ»ï¼Œä½†åœ¨ä¸åŒå°ºåº¦ä¸Šè¯†åˆ«å¯¹è±¡ä»ç„¶æ˜¯å®æ—¶ç›®æ ‡æ£€æµ‹å™¨é¢ä¸´çš„åŸºæœ¬æŒ‘æˆ˜ã€‚è¿™ä¿ƒä½¿ä½œè€…è®¾è®¡äº†ä¸€ä¸ªå¼ºå¤§çš„ç¼–ç å™¨æ¶æ„ï¼Œç”¨äºå­¦ä¹ å…·æœ‰è¡¨ç°åŠ›çš„å¤šå°ºåº¦ç‰¹å¾è¡¨ç¤ºã€‚å…·ä½“è€Œè¨€ï¼Œä½œè€…ä»ä¸¤ä¸ªæ–°çš„è§’åº¦è€ƒè™‘ä¸ºå®æ—¶ç›®æ ‡æ£€æµ‹ç¼–ç å¤šå°ºåº¦ç‰¹å¾ï¼š

ä»å±€éƒ¨è§†è§’å‡ºå‘ï¼Œä½œè€…è®¾è®¡äº†ä¸€ä¸ªå…·æœ‰ç®€å•è€Œæœ‰æ•ˆçš„åˆ†å±‚ç‰¹å¾èåˆç­–ç•¥çš„MS-Blockã€‚å—åˆ°Res2Netçš„å¯å‘ï¼Œä½œè€…åœ¨MS-Blockä¸­å¼•å…¥äº†å¤šä¸ªåˆ†æ”¯æ¥è¿›è¡Œç‰¹å¾æå–ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œä½œè€…ä½¿ç”¨äº†ä¸€ä¸ªå¸¦æœ‰æ·±åº¦å·ç§¯çš„ Inverted Bottleneck Blockå—ï¼Œä»¥å®ç°å¯¹å¤§Kernelçš„é«˜æ•ˆåˆ©ç”¨ã€‚

ä»å…¨å±€è§†è§’å‡ºå‘ï¼Œä½œè€…æå‡ºéšç€ç½‘ç»œåŠ æ·±é€æ¸å¢åŠ å·ç§¯çš„Kernel-Sizeã€‚ä½œè€…åœ¨æµ…å±‚ä½¿ç”¨å°Kernelå·ç§¯æ¥æ›´é«˜æ•ˆåœ°å¤„ç†é«˜åˆ†è¾¨ç‡ç‰¹å¾ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æ·±å±‚ä¸­ï¼Œä½œè€…é‡‡ç”¨å¤§Kernelå·ç§¯æ¥æ•æ‰å¹¿æ³›çš„ä¿¡æ¯ã€‚

åŸºäºä»¥ä¸Šè®¾è®¡åŸåˆ™ï¼Œä½œè€…å‘ˆç°äº†ä½œè€…çš„å®æ—¶ç›®æ ‡æ£€æµ‹å™¨ï¼Œç§°ä¸ºYOLO-MSã€‚ä¸ºäº†è¯„ä¼°ä½œè€…çš„YOLO-MSçš„æ€§èƒ½ï¼Œä½œè€…åœ¨MS COCOæ•°æ®é›†ä¸Šè¿›è¡Œäº†å…¨é¢çš„å®éªŒã€‚è¿˜æä¾›äº†ä¸å…¶ä»–æœ€å…ˆè¿›æ–¹æ³•çš„å®šé‡æ¯”è¾ƒï¼Œä»¥å±•ç¤ºä½œè€…æ–¹æ³•çš„å¼ºå¤§æ€§èƒ½ã€‚å¦‚å›¾1æ‰€ç¤ºï¼ŒYOLO-MSåœ¨è®¡ç®—æ€§èƒ½å¹³è¡¡æ–¹é¢ä¼˜äºå…¶ä»–è¿‘æœŸçš„å®æ—¶ç›®æ ‡æ£€æµ‹å™¨ã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/9ab694da7c594544811a74860db51416.png)


å…·ä½“è€Œè¨€ï¼ŒYOLO-MS-XSåœ¨MS COCOä¸Šè·å¾—äº†43%+çš„APå¾—åˆ†ï¼Œä»…å…·æœ‰450ä¸‡ä¸ªå¯å­¦ä¹ å‚æ•°å’Œ8.7äº¿ä¸ªFLOPsã€‚YOLO-MS-Så’ŒYOLO-MSåˆ†åˆ«è·å¾—äº†46%+å’Œ51%+çš„APï¼Œå¯å­¦ä¹ å‚æ•°åˆ†åˆ«ä¸º810ä¸‡å’Œ2220ä¸‡ã€‚æ­¤å¤–ï¼Œä½œè€…çš„å·¥ä½œè¿˜å¯ä»¥ä½œä¸ºå…¶ä»–YOLOæ¨¡å‹çš„å³æ’å³ç”¨æ¨¡å—ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä½œè€…çš„æ–¹æ³•å¯ä»¥å°†YOLOv11çš„APä»37%+æ˜¾è‘—æé«˜åˆ°40%+ï¼Œç”šè‡³è¿˜å¯ä»¥ä½¿ç”¨æ›´å°‘çš„å‚æ•°å’ŒFLOPsã€‚

CSP Blockæ˜¯ä¸€ä¸ªåŸºäºé˜¶æ®µçº§æ¢¯åº¦è·¯å¾„çš„ç½‘ç»œï¼Œå¹³è¡¡äº†æ¢¯åº¦ç»„åˆå’Œè®¡ç®—æˆæœ¬ã€‚å®ƒæ˜¯å¹¿æ³›åº”ç”¨äºYOLOç³»åˆ—çš„åŸºæœ¬æ„å»ºå—ã€‚å·²ç»æå‡ºäº†å‡ ç§å˜ä½“ï¼ŒåŒ…æ‹¬YOLOv4å’ŒYOLOv11ä¸­çš„åŸå§‹ç‰ˆæœ¬ï¼ŒScaled YOLOv4ä¸­çš„CSPVoVNetï¼ŒYOLOv11ä¸­çš„ELANï¼Œä»¥åŠRTMDetä¸­æå‡ºçš„å¤§Kernelå•å…ƒã€‚ä½œè€…åœ¨å›¾2(a)å’Œå›¾2(b)ä¸­åˆ†åˆ«å±•ç¤ºäº†åŸå§‹CSPå—å’ŒELANçš„ç»“æ„ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/d7239c693fdc4d878f9b1b31566e20f4.png)


ä¸Šè¿°å®æ—¶æ£€æµ‹å™¨ä¸­è¢«å¿½è§†çš„ä¸€ä¸ªå…³é”®æ–¹é¢æ˜¯å¦‚ä½•åœ¨åŸºæœ¬æ„å»ºå—ä¸­ç¼–ç å¤šå°ºåº¦ç‰¹å¾ã€‚å…¶ä¸­ä¸€ä¸ªå¼ºå¤§çš„è®¾è®¡åŸåˆ™æ˜¯Res2Netï¼Œå®ƒèšåˆäº†æ¥è‡ªä¸åŒå±‚æ¬¡çš„ç‰¹å¾ä»¥å¢å¼ºå¤šå°ºåº¦è¡¨ç¤ºã€‚ç„¶è€Œï¼Œè¿™ä¸€åŸåˆ™å¹¶æ²¡æœ‰å……åˆ†æ¢ç´¢å¤§Kernelå·ç§¯çš„ä½œç”¨ï¼Œè€Œå¤§Kernelå·ç§¯å·²ç»åœ¨åŸºäºCNNçš„è§†è§‰è¯†åˆ«ä»»åŠ¡æ¨¡å‹ä¸­è¯æ˜æœ‰æ•ˆã€‚å°†å¤§Kernelå·ç§¯çº³å…¥Res2Netçš„ä¸»è¦éšœç¢åœ¨äºå®ƒä»¬å¼•å…¥çš„è®¡ç®—å¼€é”€ï¼Œå› ä¸ºæ„å»ºå—é‡‡ç”¨äº†æ ‡å‡†å·ç§¯ã€‚åœ¨ä½œè€…çš„æ–¹æ³•ä¸­ï¼Œä½œè€…æå‡ºç”¨ Inverted Bottleneck Blockæ›¿ä»£æ ‡å‡†çš„3 Ã— 3å·ç§¯ï¼Œä»¥äº«å—å¤§Kernelå·ç§¯çš„å¥½å¤„ã€‚

#### MS-Block

åŸºäºå‰é¢çš„åˆ†æï¼Œå‚è€ƒè¯¥åšå®¢æå‡ºäº†ä¸€ä¸ªå¸¦æœ‰åˆ†å±‚ç‰¹å¾èåˆç­–ç•¥çš„å…¨æ–°Blockï¼Œç§°ä¸ºMS-Blockï¼Œä»¥å¢å¼ºå®æ—¶ç›®æ ‡æ£€æµ‹å™¨åœ¨æå–å¤šå°ºåº¦ç‰¹å¾æ—¶çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä¿æŒå¿«é€Ÿçš„æ¨ç†é€Ÿåº¦ã€‚

MS-Blockçš„å…·ä½“ç»“æ„å¦‚å›¾2(c)æ‰€ç¤ºã€‚å‡è®¾æ˜¯è¾“å…¥ç‰¹å¾ã€‚é€šè¿‡1Ã—1å·ç§¯çš„è½¬æ¢åï¼ŒXçš„é€šé“ç»´åº¦å¢åŠ åˆ°n*Cã€‚ç„¶åï¼Œä½œè€…å°†Xåˆ†å‰²æˆnä¸ªä¸åŒçš„ç»„ï¼Œè¡¨ç¤ºä¸ºï¼Œå…¶ä¸­ã€‚ä¸ºäº†é™ä½è®¡ç®—æˆæœ¬ï¼Œä½œè€…é€‰æ‹©nä¸º3ã€‚

æ³¨æ„ï¼Œé™¤äº†ä¹‹å¤–ï¼Œæ¯ä¸ªå…¶ä»–ç»„éƒ½ç»è¿‡ä¸€ä¸ª Inverted Bottleneck Blockå±‚ï¼Œç”¨è¡¨ç¤ºï¼Œå…¶ä¸­kè¡¨ç¤ºKernel-Sizeï¼Œä»¥è·å¾—ã€‚çš„æ•°å­¦è¡¨ç¤ºå¦‚ä¸‹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/be548cea35614fbab018018b6fb624c7.png)


æ ¹æ®è¿™ä¸ªå…¬å¼ï¼Œä½œè€…ä¸å°† Inverted Bottleneck Blockå±‚è¿æ¥åˆ°ï¼Œä½¿å…¶ä½œä¸ºè·¨é˜¶æ®µè¿æ¥ï¼Œå¹¶ä¿ç•™æ¥è‡ªå‰é¢å±‚çš„ä¿¡æ¯ã€‚æœ€åï¼Œä½œè€…å°†æ‰€æœ‰åˆ†å‰²è¿æ¥åœ¨ä¸€èµ·ï¼Œå¹¶åº”ç”¨1Ã—1å·ç§¯æ¥åœ¨æ‰€æœ‰åˆ†å‰²ä¹‹é—´è¿›è¡Œäº¤äº’ï¼Œæ¯ä¸ªåˆ†å‰²éƒ½ç¼–ç ä¸åŒå°ºåº¦çš„ç‰¹å¾ã€‚å½“ç½‘ç»œåŠ æ·±æ—¶ï¼Œè¿™ä¸ª1Ã—1å·ç§¯ä¹Ÿç”¨äºè°ƒæ•´é€šé“æ•°ã€‚

#### Heterogeneous Kernel Selection Protocol
é™¤äº†æ„å»ºå—çš„è®¾è®¡å¤–ï¼Œä½œè€…è¿˜ä»å®è§‚è§’åº¦æ¢è®¨äº†å·ç§¯çš„ä½¿ç”¨ã€‚ä¹‹å‰çš„å®æ—¶ç›®æ ‡æ£€æµ‹å™¨åœ¨ä¸åŒçš„ç¼–ç å™¨é˜¶æ®µé‡‡ç”¨äº†åŒè´¨å·ç§¯ï¼ˆå³å…·æœ‰ç›¸åŒKernel-Sizeçš„å·ç§¯ï¼‰ï¼Œä½†ä½œè€…è®¤ä¸ºè¿™ä¸æ˜¯æå–å¤šå°ºåº¦è¯­ä¹‰ä¿¡æ¯çš„æœ€ä½³é€‰é¡¹ã€‚

åœ¨é‡‘å­—å¡”ç»“æ„ä¸­ï¼Œä»æ£€æµ‹å™¨çš„æµ…é˜¶æ®µæå–çš„é«˜åˆ†è¾¨ç‡ç‰¹å¾é€šå¸¸ç”¨äºæ•æ‰ç»†ç²’åº¦è¯­ä¹‰ï¼Œå°†ç”¨äºæ£€æµ‹å°ç›®æ ‡ã€‚ç›¸åï¼Œæ¥è‡ªç½‘ç»œè¾ƒæ·±é˜¶æ®µçš„ä½åˆ†è¾¨ç‡ç‰¹å¾ç”¨äºæ•æ‰é«˜çº§è¯­ä¹‰ï¼Œå°†ç”¨äºæ£€æµ‹å¤§ç›®æ ‡ã€‚å¦‚æœä½œè€…åœ¨æ‰€æœ‰é˜¶æ®µéƒ½é‡‡ç”¨ç»Ÿä¸€çš„å°Kernelå·ç§¯ï¼Œæ·±é˜¶æ®µçš„æœ‰æ•ˆæ„Ÿå—é‡ï¼ˆERFï¼‰å°†å—åˆ°é™åˆ¶ï¼Œå½±å“å¤§ç›®æ ‡çš„æ€§èƒ½ã€‚åœ¨æ¯ä¸ªé˜¶æ®µä¸­å¼•å…¥å¤§Kernelå·ç§¯å¯ä»¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç„¶è€Œï¼Œå…·æœ‰å¤§çš„ERFçš„å¤§Kernelå¯ä»¥ç¼–ç æ›´å¹¿æ³›çš„åŒºåŸŸï¼Œè¿™å¢åŠ äº†åœ¨å°ç›®æ ‡å¤–éƒ¨åŒ…å«å™ªå£°ä¿¡æ¯çš„æ¦‚ç‡ï¼Œå¹¶ä¸”é™ä½äº†æ¨ç†é€Ÿåº¦ã€‚

åœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œä½œè€…å»ºè®®åœ¨ä¸åŒé˜¶æ®µä¸­é‡‡ç”¨å¼‚æ„å·ç§¯ï¼Œä»¥å¸®åŠ©æ•è·æ›´ä¸°å¯Œçš„å¤šå°ºåº¦ç‰¹å¾ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ç¼–ç å™¨çš„ç¬¬ä¸€ä¸ªé˜¶æ®µä¸­ï¼Œä½œè€…é‡‡ç”¨æœ€å°Kernelå·ç§¯ï¼Œè€Œæœ€å¤§Kernelå·ç§¯ä½äºæœ€åä¸€ä¸ªé˜¶æ®µã€‚éšåï¼Œä½œè€…é€æ­¥å¢åŠ ä¸­é—´é˜¶æ®µçš„Kernel-Sizeï¼Œä½¿å…¶ä¸ç‰¹å¾åˆ†è¾¨ç‡çš„å¢åŠ ä¿æŒä¸€è‡´ã€‚è¿™ç§ç­–ç•¥å…è®¸æå–ç»†ç²’åº¦å’Œç²—ç²’åº¦çš„è¯­ä¹‰ä¿¡æ¯ï¼Œå¢å¼ºäº†ç¼–ç å™¨çš„å¤šå°ºåº¦ç‰¹å¾è¡¨ç¤ºèƒ½åŠ›ã€‚

æ­£å¦‚å›¾æ‰€ç¤ºï¼Œä½œè€…å°†kçš„å€¼åˆ†åˆ«åˆ†é…ç»™ç¼–ç å™¨ä¸­çš„æµ…é˜¶æ®µåˆ°æ·±é˜¶æ®µï¼Œå–å€¼ä¸º3ã€5ã€7å’Œ9ã€‚ä½œè€…å°†å…¶ç§°ä¸ºå¼‚æ„Kernelé€‰æ‹©ï¼ˆHKSï¼‰åè®®ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/98272afa671246d3aff8d03a56371527.png)


ä½œè€…çš„HKSåè®®èƒ½å¤Ÿåœ¨æ·±å±‚ä¸­æ‰©å¤§æ„Ÿå—é‡ï¼Œè€Œä¸ä¼šå¯¹æµ…å±‚äº§ç”Ÿä»»ä½•å…¶ä»–å½±å“ã€‚ç¬¬4èŠ‚çš„å›¾4æ”¯æŒäº†ä½œè€…çš„åˆ†æã€‚æ­¤å¤–ï¼ŒHKSä¸ä»…æœ‰åŠ©äºç¼–ç æ›´ä¸°å¯Œçš„å¤šå°ºåº¦ç‰¹å¾ï¼Œè¿˜ç¡®ä¿äº†é«˜æ•ˆçš„æ¨ç†ã€‚

å¦‚è¡¨1æ‰€ç¤ºï¼Œå°†å¤§Kernelå·ç§¯åº”ç”¨äºé«˜åˆ†è¾¨ç‡ç‰¹å¾ä¼šäº§ç”Ÿè¾ƒé«˜çš„è®¡ç®—å¼€é”€ã€‚ç„¶è€Œï¼Œä½œè€…çš„HKSåè®®åœ¨ä½åˆ†è¾¨ç‡ç‰¹å¾ä¸Šé‡‡ç”¨å¤§Kernelå·ç§¯ï¼Œä»è€Œä¸ä»…ä½¿ç”¨å¤§Kernelå·ç§¯ç›¸æ¯”ï¼Œå¤§å¤§é™ä½äº†è®¡ç®—æˆæœ¬ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/a28ea816451c491aa207b11d906ce285.png)


åœ¨å®è·µä¸­ï¼Œä½œè€…ç»éªŒæ€§åœ°å‘ç°ï¼Œé‡‡ç”¨HKSåè®®çš„YOLO-MSçš„æ¨ç†é€Ÿåº¦å‡ ä¹ä¸ä»…ä½¿ç”¨æ·±åº¦å¯åˆ†ç¦»çš„3 Ã— 3å·ç§¯ç›¸åŒã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/44e5893cec834594a6d8af727702cf26.png)

å¦‚å›¾æ‰€ç¤ºï¼Œä½œè€…æ¨¡å‹çš„Backboneç”±4ä¸ªé˜¶æ®µç»„æˆï¼Œæ¯ä¸ªé˜¶æ®µåé¢è·Ÿéš1ä¸ªæ­¥é•¿ä¸º2çš„3 Ã— 3å·ç§¯è¿›è¡Œä¸‹é‡‡æ ·ã€‚åœ¨ç¬¬3ä¸ªé˜¶æ®µåï¼Œä½œè€…æ·»åŠ äº†1ä¸ªSPPå—ï¼Œä¸RTMDetä¸­ä¸€æ ·ã€‚åœ¨ä½œè€…çš„ç¼–ç å™¨ä¸Šï¼Œä½œè€…ä½¿ç”¨PAFPNä½œä¸ºNeckæ¥æ„å»ºç‰¹å¾é‡‘å­—å¡”[31, 35]ã€‚å®ƒèåˆäº†ä»Backboneä¸åŒé˜¶æ®µæå–çš„å¤šå°ºåº¦ç‰¹å¾ã€‚Neckä¸­ä½¿ç”¨çš„åŸºæœ¬æ„å»ºå—ä¹Ÿæ˜¯ä½œè€…çš„MS-Blockï¼Œåœ¨å…¶ä¸­ä½¿ç”¨3 Ã— 3æ·±åº¦å¯åˆ†ç¦»å·ç§¯è¿›è¡Œå¿«é€Ÿæ¨ç†ã€‚

æ­¤å¤–ï¼Œä¸ºäº†åœ¨é€Ÿåº¦å’Œå‡†ç¡®æ€§ä¹‹é—´å–å¾—æ›´å¥½çš„å¹³è¡¡ï¼Œä½œè€…å°†Backboneä¸­å¤šçº§ç‰¹å¾çš„é€šé“æ·±åº¦å‡åŠã€‚ä½œè€…æä¾›äº†3ä¸ªä¸åŒå°ºåº¦çš„YOLO-MSå˜ä½“ï¼Œå³YOLO-MS-XSã€YOLO-MS-Så’ŒYOLO-MSã€‚ä¸åŒå°ºåº¦çš„YOLO-MSçš„è¯¦ç»†é…ç½®åˆ—åœ¨è¡¨2ä¸­ã€‚å¯¹äºYOLO-MSçš„å…¶ä»–éƒ¨åˆ†ï¼Œä½œè€…å°†å…¶ä¿æŒä¸RTMDetç›¸åŒã€‚


### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤º

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10. YOLOv11æ ¸å¿ƒæ”¹è¿›æºç è®²è§£

#### 10.1 CSwomTramsformer.py

ä»¥ä¸‹æ˜¯å¯¹ç»™å®šä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œæç‚¼å’Œè¯¦ç»†æ³¨é‡Šçš„ç»“æœã€‚ä¸»è¦ä¿ç•™äº†æ¨¡å‹çš„å®šä¹‰å’Œå‰å‘ä¼ æ’­çš„é€»è¾‘ï¼Œå»æ‰äº†ä¸€äº›ä¸å¿…è¦çš„éƒ¨åˆ†ï¼Œå¦‚åŠ è½½é¢„è®­ç»ƒæ¨¡å‹çš„ä»£ç å’Œä¸»å‡½æ•°çš„æµ‹è¯•éƒ¨åˆ†ã€‚

```python
import torch
import torch.nn as nn
import numpy as np

class Mlp(nn.Module):
    """å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰æ¨¡å—"""
    def __init__(self, in_features, hidden_features=None, out_features=None, act_layer=nn.GELU, drop=0.):
        super().__init__()
        out_features = out_features or in_features  # è¾“å‡ºç‰¹å¾æ•°
        hidden_features = hidden_features or in_features  # éšè—å±‚ç‰¹å¾æ•°
        self.fc1 = nn.Linear(in_features, hidden_features)  # ç¬¬ä¸€å±‚çº¿æ€§å˜æ¢
        self.act = act_layer()  # æ¿€æ´»å‡½æ•°
        self.fc2 = nn.Linear(hidden_features, out_features)  # ç¬¬äºŒå±‚çº¿æ€§å˜æ¢
        self.drop = nn.Dropout(drop)  # Dropoutå±‚

    def forward(self, x):
        """å‰å‘ä¼ æ’­"""
        x = self.fc1(x)  # çº¿æ€§å˜æ¢
        x = self.act(x)  # æ¿€æ´»
        x = self.drop(x)  # Dropout
        x = self.fc2(x)  # çº¿æ€§å˜æ¢
        x = self.drop(x)  # Dropout
        return x

class LePEAttention(nn.Module):
    """å±€éƒ¨å¢å¼ºæ³¨æ„åŠ›ï¼ˆLePEï¼‰æ¨¡å—"""
    def __init__(self, dim, resolution, idx, split_size=7, num_heads=8, attn_drop=0.):
        super().__init__()
        self.dim = dim  # è¾“å…¥ç‰¹å¾ç»´åº¦
        self.resolution = resolution  # è¾“å…¥åˆ†è¾¨ç‡
        self.split_size = split_size  # åˆ‡åˆ†çª—å£å¤§å°
        self.num_heads = num_heads  # æ³¨æ„åŠ›å¤´æ•°
        head_dim = dim // num_heads  # æ¯ä¸ªå¤´çš„ç»´åº¦
        self.scale = head_dim ** -0.5  # ç¼©æ”¾å› å­
        self.get_v = nn.Conv2d(dim, dim, kernel_size=3, stride=1, padding=1, groups=dim)  # ç”¨äºè·å–vçš„å·ç§¯å±‚
        self.attn_drop = nn.Dropout(attn_drop)  # æ³¨æ„åŠ›Dropout

    def im2cswin(self, x):
        """å°†è¾“å…¥è½¬æ¢ä¸ºçª—å£å½¢å¼"""
        B, N, C = x.shape
        H = W = int(np.sqrt(N))  # è®¡ç®—é«˜åº¦å’Œå®½åº¦
        x = x.transpose(-2, -1).contiguous().view(B, C, H, W)  # è½¬æ¢å½¢çŠ¶
        x = img2windows(x, self.split_size, self.split_size)  # åˆ‡åˆ†çª—å£
        return x

    def forward(self, qkv):
        """å‰å‘ä¼ æ’­"""
        q, k, v = qkv  # è·å–q, k, v
        q = self.im2cswin(q)  # å°†qè½¬æ¢ä¸ºçª—å£å½¢å¼
        k = self.im2cswin(k)  # å°†kè½¬æ¢ä¸ºçª—å£å½¢å¼
        v = self.get_v(v)  # é€šè¿‡å·ç§¯è·å–v
        q = q * self.scale  # ç¼©æ”¾q
        attn = (q @ k.transpose(-2, -1))  # è®¡ç®—æ³¨æ„åŠ›
        attn = nn.functional.softmax(attn, dim=-1)  # softmaxå½’ä¸€åŒ–
        attn = self.attn_drop(attn)  # åº”ç”¨Dropout
        x = attn @ v  # è®¡ç®—åŠ æƒå’Œ
        return x

class CSWinBlock(nn.Module):
    """CSWin Transformerçš„åŸºæœ¬å—"""
    def __init__(self, dim, reso, num_heads, split_size=7, mlp_ratio=4.):
        super().__init__()
        self.dim = dim  # è¾“å…¥ç‰¹å¾ç»´åº¦
        self.num_heads = num_heads  # æ³¨æ„åŠ›å¤´æ•°
        self.qkv = nn.Linear(dim, dim * 3)  # çº¿æ€§å±‚ç”¨äºç”Ÿæˆq, k, v
        self.norm1 = nn.LayerNorm(dim)  # å½’ä¸€åŒ–å±‚
        self.attn = LePEAttention(dim, resolution=reso, idx=0, split_size=split_size, num_heads=num_heads)  # æ³¨æ„åŠ›å±‚
        self.mlp = Mlp(in_features=dim, hidden_features=int(dim * mlp_ratio), out_features=dim)  # MLPå±‚
        self.norm2 = nn.LayerNorm(dim)  # å½’ä¸€åŒ–å±‚

    def forward(self, x):
        """å‰å‘ä¼ æ’­"""
        x = self.norm1(x)  # å½’ä¸€åŒ–
        qkv = self.qkv(x).reshape(x.shape[0], -1, 3, self.dim).permute(2, 0, 1, 3)  # ç”Ÿæˆq, k, v
        x = self.attn(qkv)  # è®¡ç®—æ³¨æ„åŠ›
        x = x + self.norm2(x)  # åŠ ä¸Šå½’ä¸€åŒ–åçš„è¾“å…¥
        x = x + self.mlp(x)  # åŠ ä¸ŠMLPçš„è¾“å‡º
        return x

class CSWinTransformer(nn.Module):
    """CSWin Transformeræ¨¡å‹"""
    def __init__(self, img_size=640, in_chans=3, num_classes=1000, embed_dim=96, depth=[2, 2, 6, 2], num_heads=12):
        super().__init__()
        self.stage1_conv_embed = nn.Sequential(
            nn.Conv2d(in_chans, embed_dim, 7, 4, 2),  # åˆå§‹å·ç§¯å±‚
            nn.LayerNorm(embed_dim)  # å½’ä¸€åŒ–å±‚
        )
        self.stage1 = nn.ModuleList([
            CSWinBlock(dim=embed_dim, num_heads=num_heads) for _ in range(depth[0])  # ç¬¬ä¸€é˜¶æ®µçš„CSWinå—
        ])
        # å…¶ä»–é˜¶æ®µçš„å®šä¹‰çœç•¥...

    def forward(self, x):
        """å‰å‘ä¼ æ’­"""
        x = self.stage1_conv_embed(x)  # é€šè¿‡åˆå§‹å·ç§¯å±‚
        for blk in self.stage1:
            x = blk(x)  # é€šè¿‡æ¯ä¸ªCSWinå—
        return x

# img2windows å’Œ windows2img å‡½æ•°çœç•¥...
```

### ä¸»è¦éƒ¨åˆ†è¯´æ˜ï¼š
1. **Mlpç±»**ï¼šå®ç°äº†ä¸€ä¸ªç®€å•çš„å¤šå±‚æ„ŸçŸ¥æœºï¼ŒåŒ…å«ä¸¤ä¸ªçº¿æ€§å±‚å’Œä¸€ä¸ªæ¿€æ´»å‡½æ•°ã€‚
2. **LePEAttentionç±»**ï¼šå®ç°äº†å±€éƒ¨å¢å¼ºæ³¨æ„åŠ›æœºåˆ¶ï¼Œè´Ÿè´£å°†è¾“å…¥è½¬æ¢ä¸ºçª—å£å½¢å¼å¹¶è®¡ç®—æ³¨æ„åŠ›ã€‚
3. **CSWinBlockç±»**ï¼šå®šä¹‰äº†CSWin Transformerçš„åŸºæœ¬å—ï¼ŒåŒ…å«æ³¨æ„åŠ›å±‚å’ŒMLPå±‚ã€‚
4. **CSWinTransformerç±»**ï¼šæ•´ä½“æ¨¡å‹çš„å®šä¹‰ï¼ŒåŒ…å«å¤šä¸ªCSWinå—å’Œåˆå§‹å·ç§¯å±‚ã€‚

ä»¥ä¸Šä»£ç ä¿ç•™äº†æ¨¡å‹çš„æ ¸å¿ƒç»“æ„å’Œå‰å‘ä¼ æ’­é€»è¾‘ï¼Œå»æ‰äº†ä¸æ¨¡å‹åŠ è½½å’Œæµ‹è¯•ç›¸å…³çš„éƒ¨åˆ†ã€‚

è¯¥æ–‡ä»¶å®ç°äº†ä¸€ä¸ªåä¸ºCSWin Transformerçš„è§†è§‰å˜æ¢å™¨æ¨¡å‹ï¼Œä¸»è¦ç”¨äºå›¾åƒåˆ†ç±»ç­‰è®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚ä»£ç çš„ç»“æ„åˆ†ä¸ºå¤šä¸ªç±»å’Œå‡½æ•°ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰å…¶ç‰¹å®šçš„åŠŸèƒ½ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬PyTorchåŠå…¶ç›¸å…³æ¨¡å—ã€NumPyå’Œä¸€äº›ç”¨äºå›¾åƒå¤„ç†çš„å·¥å…·ã€‚æ–‡ä»¶çš„å¼€å¤´éƒ¨åˆ†å®šä¹‰äº†ä¸€äº›å¸¸é‡å’Œå…¨å±€å˜é‡ï¼Œæ¥ç€å®šä¹‰äº†å¤šä¸ªç±»ï¼Œåˆ†åˆ«å®ç°äº†æ¨¡å‹çš„ä¸åŒç»„ä»¶ã€‚

Mlpç±»å®ç°äº†ä¸€ä¸ªå¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼ŒåŒ…å«ä¸¤ä¸ªçº¿æ€§å±‚å’Œä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼ˆé»˜è®¤ä¸ºGELUï¼‰ï¼Œç”¨äºç‰¹å¾çš„éçº¿æ€§å˜æ¢ã€‚LePEAttentionç±»å®ç°äº†å±€éƒ¨å¢å¼ºæ³¨æ„åŠ›æœºåˆ¶ï¼ŒåŒ…å«å¤šä¸ªå¤´çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€‚å®ƒçš„æ„é€ å‡½æ•°æ¥æ”¶å¤šä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬è¾“å…¥ç»´åº¦ã€åˆ†è¾¨ç‡ã€åˆ†å‰²å¤§å°ã€å¤´æ•°ç­‰ã€‚è¯¥ç±»çš„forwardæ–¹æ³•å®ç°äº†è¾“å…¥çš„æŸ¥è¯¢ã€é”®ã€å€¼çš„è®¡ç®—ï¼Œå¹¶é€šè¿‡æ³¨æ„åŠ›æœºåˆ¶å¯¹è¾“å…¥è¿›è¡ŒåŠ æƒã€‚

CSWinBlockç±»æ˜¯CSWin Transformerçš„åŸºæœ¬æ„å»ºå—ï¼Œç»“åˆäº†MLPå’Œæ³¨æ„åŠ›æœºåˆ¶ã€‚å®ƒçš„æ„é€ å‡½æ•°å®šä¹‰äº†å¤šä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬è¾“å…¥ç»´åº¦ã€åˆ†è¾¨ç‡ã€å¤´æ•°ç­‰ã€‚forwardæ–¹æ³•å®ç°äº†å—å†…çš„å‰å‘ä¼ æ’­ï¼Œé¦–å…ˆå¯¹è¾“å…¥è¿›è¡Œå½’ä¸€åŒ–ï¼Œç„¶åè®¡ç®—æŸ¥è¯¢ã€é”®ã€å€¼ï¼Œå¹¶é€šè¿‡æ³¨æ„åŠ›æœºåˆ¶å’ŒMLPè¿›è¡Œç‰¹å¾æå–ã€‚

æ¥ä¸‹æ¥ï¼Œimg2windowså’Œwindows2imgå‡½æ•°ç”¨äºå°†å›¾åƒä»ç©ºé—´åŸŸè½¬æ¢ä¸ºçª—å£åŸŸå’Œåå‘è½¬æ¢ï¼Œæ”¯æŒå¯¹å›¾åƒè¿›è¡Œåˆ†å—å¤„ç†ã€‚Merge_Blockç±»ç”¨äºåˆå¹¶ç‰¹å¾å›¾ï¼Œä½¿ç”¨å·ç§¯å±‚å’Œå½’ä¸€åŒ–å±‚æ¥å¤„ç†ç‰¹å¾ã€‚

CSWinTransformerç±»æ˜¯æ•´ä¸ªæ¨¡å‹çš„æ ¸å¿ƒï¼ŒåŒ…å«å¤šä¸ªé˜¶æ®µçš„æ„å»ºï¼Œæ¯ä¸ªé˜¶æ®µç”±å¤šä¸ªCSWinBlockç»„æˆã€‚æ„é€ å‡½æ•°å®šä¹‰äº†è¾“å…¥å›¾åƒçš„å¤§å°ã€è¡¥ä¸å¤§å°ã€é€šé“æ•°ã€ç±»åˆ«æ•°ç­‰å‚æ•°ï¼Œå¹¶é€æ­¥æ„å»ºæ¨¡å‹çš„å„ä¸ªé˜¶æ®µã€‚forward_featuresæ–¹æ³•è´Ÿè´£ç‰¹å¾æå–ï¼Œé€å±‚é€šè¿‡å„ä¸ªå—å¹¶åˆå¹¶ç‰¹å¾ã€‚

æœ€åï¼Œæ–‡ä»¶å®šä¹‰äº†ä¸€äº›è¾…åŠ©å‡½æ•°ï¼Œä¾‹å¦‚_conv_filterç”¨äºè½¬æ¢æƒé‡ï¼Œupdate_weightç”¨äºæ›´æ–°æ¨¡å‹æƒé‡ï¼Œä»¥åŠCSWin_tinyã€CSWin_smallã€CSWin_baseå’ŒCSWin_largeå‡½æ•°ç”¨äºåˆ›å»ºä¸åŒè§„æ¨¡çš„CSWin Transformeræ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼ŒåŒ…å«äº†ä¸€ä¸ªæµ‹è¯•ä»£ç å—ï¼Œåˆ›å»ºäº†ä¸åŒè§„æ¨¡çš„æ¨¡å‹å¹¶å¯¹éšæœºè¾“å…¥è¿›è¡Œå‰å‘ä¼ æ’­ï¼Œè¾“å‡ºæ¯ä¸ªæ¨¡å‹çš„ç‰¹å¾å›¾å¤§å°ã€‚è¿™æ®µä»£ç ç”¨äºéªŒè¯æ¨¡å‹çš„æ­£ç¡®æ€§å’ŒåŠŸèƒ½ã€‚

æ•´ä½“è€Œè¨€ï¼Œè¯¥æ–‡ä»¶å®ç°äº†ä¸€ä¸ªé«˜æ•ˆçš„è§†è§‰å˜æ¢å™¨æ¨¡å‹ï¼Œåˆ©ç”¨å±€éƒ¨å¢å¼ºæ³¨æ„åŠ›æœºåˆ¶å’Œå¤šå±‚æ„ŸçŸ¥æœºçš„ç»„åˆï¼Œé€‚ç”¨äºå„ç§è®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚

#### 10.2 block.py

ä»¥ä¸‹æ˜¯ä¿ç•™çš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

def autopad(k, p=None, d=1):
    """è‡ªåŠ¨å¡«å……ä»¥ä¿æŒè¾“å‡ºå½¢çŠ¶ç›¸åŒã€‚"""
    if d > 1:
        k = d * (k - 1) + 1 if isinstance(k, int) else [d * (x - 1) + 1 for x in k]  # å®é™…çš„å·ç§¯æ ¸å¤§å°
    if p is None:
        p = k // 2 if isinstance(k, int) else [x // 2 for x in k]  # è‡ªåŠ¨å¡«å……
    return p

class Conv(nn.Module):
    """å·ç§¯å±‚ï¼ŒåŒ…å«å·ç§¯ã€æ‰¹å½’ä¸€åŒ–å’Œæ¿€æ´»å‡½æ•°ã€‚"""
    def __init__(self, in_channels, out_channels, kernel_size=3, stride=1, padding=None, groups=1, act=True):
        super().__init__()
        self.conv = nn.Conv2d(in_channels, out_channels, kernel_size, stride, autopad(kernel_size, padding), groups=groups, bias=False)
        self.bn = nn.BatchNorm2d(out_channels)
        self.act = nn.SiLU() if act else nn.Identity()  # ä½¿ç”¨SiLUæ¿€æ´»å‡½æ•°

    def forward(self, x):
        """å‰å‘ä¼ æ’­ã€‚"""
        return self.act(self.bn(self.conv(x)))

class Bottleneck(nn.Module):
    """æ ‡å‡†ç“¶é¢ˆç»“æ„ã€‚"""
    def __init__(self, c1, c2, shortcut=True, g=1, k=(3, 3), e=0.5):
        super().__init__()
        c_ = int(c2 * e)  # éšè—é€šé“æ•°
        self.cv1 = Conv(c1, c_, k[0], 1)  # ç¬¬ä¸€ä¸ªå·ç§¯
        self.cv2 = Conv(c_, c2, k[1], 1, g=g)  # ç¬¬äºŒä¸ªå·ç§¯
        self.add = shortcut and c1 == c2  # æ˜¯å¦ä½¿ç”¨shortcutè¿æ¥

    def forward(self, x):
        """å‰å‘ä¼ æ’­ã€‚"""
        return x + self.cv2(self.cv1(x)) if self.add else self.cv2(self.cv1(x))

class C3k(nn.Module):
    """C3kæ¨¡å—ï¼ŒåŒ…å«å¤šä¸ªç“¶é¢ˆç»“æ„ã€‚"""
    def __init__(self, c1, c2, n=1, shortcut=False, g=1, e=0.5, k=3):
        super().__init__()
        self.m = nn.Sequential(*(Bottleneck(c1, c2, shortcut, g, k=(k, k), e=e) for _ in range(n)))  # åˆ›å»ºnä¸ªç“¶é¢ˆå±‚

    def forward(self, x):
        """å‰å‘ä¼ æ’­ã€‚"""
        return self.m(x)

class C3k2(nn.Module):
    """C3k2æ¨¡å—ï¼ŒåŒ…å«å¤šä¸ªC3kæ¨¡å—ã€‚"""
    def __init__(self, c1, c2, n=1, c3k=False, e=0.5, g=1, shortcut=True):
        super().__init__()
        self.m = nn.ModuleList(C3k(c1, c2, n, shortcut, g, e) for _ in range(n))  # åˆ›å»ºnä¸ªC3kå±‚

    def forward(self, x):
        """å‰å‘ä¼ æ’­ã€‚"""
        for layer in self.m:
            x = layer(x)
        return x

class DynamicConv(nn.Module):
    """åŠ¨æ€å·ç§¯å±‚ã€‚"""
    def __init__(self, c1, c2, k=1, s=1, p=None, g=1, d=1, act=True, num_experts=4):
        super().__init__()
        self.conv = nn.Sequential(
            DynamicConv_Single(c1, c2, kernel_size=k, stride=s, padding=autopad(k, p, d), dilation=d, groups=g, num_experts=num_experts),
            nn.BatchNorm2d(c2),
            nn.SiLU() if act else nn.Identity()
        )

    def forward(self, x):
        """å‰å‘ä¼ æ’­ã€‚"""
        return self.conv(x)

class DynamicConv_Single(nn.Module):
    """åŠ¨æ€å·ç§¯å•å…ƒã€‚"""
    def __init__(self, in_features, out_features, kernel_size=1, stride=1, padding='', dilation=1,
                 groups=1, bias=False, num_experts=4):
        super().__init__()
        self.routing = nn.Linear(in_features, num_experts)  # è·¯ç”±å±‚
        self.cond_conv = CondConv2d(in_features, out_features, kernel_size, stride, padding, dilation,
                 groups, bias, num_experts)  # æ¡ä»¶å·ç§¯å±‚

    def forward(self, x):
        """å‰å‘ä¼ æ’­ã€‚"""
        pooled_inputs = F.adaptive_avg_pool2d(x, 1).flatten(1)  # è®¡ç®—æ¡ä»¶å·ç§¯çš„è·¯ç”±
        routing_weights = torch.sigmoid(self.routing(pooled_inputs))  # è®¡ç®—è·¯ç”±æƒé‡
        x = self.cond_conv(x, routing_weights)  # åº”ç”¨æ¡ä»¶å·ç§¯
        return x

class C3k_DynamicConv(C3k):
    """C3kæ¨¡å—ï¼Œä½¿ç”¨åŠ¨æ€å·ç§¯ã€‚"""
    def __init__(self, c1, c2, n=1, shortcut=False, g=1, e=0.5, k=3):
        super().__init__(c1, c2, n, shortcut, g, e, k)
        c_ = int(c2 * e)  # éšè—é€šé“æ•°
        self.m = nn.Sequential(*(Bottleneck_DynamicConv(c_, c_, shortcut, g, k=(k, k), e=1.0) for _ in range(n)))  # åˆ›å»ºnä¸ªåŠ¨æ€å·ç§¯ç“¶é¢ˆå±‚

    def forward(self, x):
        """å‰å‘ä¼ æ’­ã€‚"""
        return self.m(x)

# å…¶ä»–æ¨¡å—çœç•¥ï¼Œä¿ç•™ä¸Šè¿°æ ¸å¿ƒéƒ¨åˆ†åŠæ³¨é‡Š
```

ä¸Šè¿°ä»£ç åŒ…å«äº†åŠ¨æ€å·ç§¯ã€ç“¶é¢ˆç»“æ„å’ŒC3kæ¨¡å—çš„å®ç°ï¼Œæ³¨é‡Šè¯¦ç»†è§£é‡Šäº†æ¯ä¸ªç±»å’Œæ–¹æ³•çš„åŠŸèƒ½ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `block.py` æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„æ¨¡å—ï¼Œç‰¹åˆ«æ˜¯ç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„æ¨¡å‹ã€‚æ–‡ä»¶ä¸­åŒ…å«äº†å¤šä¸ªç±»å’Œå‡½æ•°ï¼Œè¿™äº›ç±»å’Œå‡½æ•°å®ç°äº†ä¸åŒçš„å·ç§¯å±‚ã€æ³¨æ„åŠ›æœºåˆ¶ã€å—ç»“æ„ç­‰ï¼Œä¸»è¦ç”¨äºæ„å»ºç¥ç»ç½‘ç»œçš„å„ä¸ªéƒ¨åˆ†ã€‚ä»¥ä¸‹æ˜¯å¯¹æ–‡ä»¶å†…å®¹çš„è¯¦ç»†è¯´æ˜ï¼š

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†è®¸å¤šå¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬ PyTorch åŠå…¶å­æ¨¡å—ï¼ˆå¦‚ `torch.nn` å’Œ `torch.nn.functional`ï¼‰ï¼Œä»¥åŠä¸€äº›å…¶ä»–å·¥å…·åº“ï¼ˆå¦‚ `numpy` å’Œ `math`ï¼‰ã€‚è¿™äº›åº“ä¸ºåç»­çš„æ·±åº¦å­¦ä¹ æ¨¡å‹æ„å»ºæä¾›äº†åŸºç¡€ã€‚

æ–‡ä»¶çš„å¼€å¤´å®šä¹‰äº†ä¸€äº›é€šç”¨çš„å‡½æ•°ï¼Œä¾‹å¦‚ `autopad`ï¼Œç”¨äºè‡ªåŠ¨è®¡ç®—å·ç§¯æ“ä½œçš„å¡«å……ï¼Œä»¥ç¡®ä¿è¾“å‡ºå°ºå¯¸ä¸è¾“å…¥å°ºå¯¸ç›¸åŒã€‚

æ¥ä¸‹æ¥ï¼Œæ–‡ä»¶ä¸­å®šä¹‰äº†å¤šä¸ªç±»ï¼Œè¿™äº›ç±»å¯ä»¥åˆ†ä¸ºå‡ å¤§ç±»ï¼š

1. **å·ç§¯å±‚å’Œæ³¨æ„åŠ›æœºåˆ¶**ï¼šæ–‡ä»¶ä¸­å®ç°äº†å¤šç§å·ç§¯å±‚ï¼ˆå¦‚ `Conv`ã€`DWConv`ã€`DSConv`ã€`RepConv`ã€`GhostConv` ç­‰ï¼‰ï¼Œè¿™äº›å·ç§¯å±‚å¯ä»¥ç”¨äºä¸åŒçš„ç½‘ç»œç»“æ„ã€‚æ­¤å¤–ï¼Œè¿˜å®ç°äº†å¤šç§æ³¨æ„åŠ›æœºåˆ¶ï¼ˆå¦‚ `Attention`ã€`ChannelAttention`ã€`SpatialAttention` ç­‰ï¼‰ï¼Œç”¨äºå¢å¼ºæ¨¡å‹å¯¹ç‰¹å¾çš„å…³æ³¨èƒ½åŠ›ã€‚

2. **å—ç»“æ„**ï¼šæ–‡ä»¶ä¸­å®šä¹‰äº†å¤šä¸ªç½‘ç»œå—ï¼ˆå¦‚ `Bottleneck`ã€`C3k`ã€`C3k2` ç­‰ï¼‰ï¼Œè¿™äº›å—é€šå¸¸ç”±å¤šä¸ªå·ç§¯å±‚å’Œæ¿€æ´»å‡½æ•°ç»„æˆï¼Œç”¨äºæ„å»ºæ›´å¤æ‚çš„ç½‘ç»œç»“æ„ã€‚æ¯ä¸ªå—å¯ä»¥åŒ…å«ä¸åŒçš„å·ç§¯å±‚ã€æ³¨æ„åŠ›æœºåˆ¶å’Œå…¶ä»–æ“ä½œï¼Œä»¥å®ç°ç‰¹å®šçš„åŠŸèƒ½ã€‚

3. **ç‰¹å®šåŠŸèƒ½æ¨¡å—**ï¼šæ–‡ä»¶ä¸­è¿˜å®ç°äº†ä¸€äº›ç‰¹å®šåŠŸèƒ½çš„æ¨¡å—ï¼Œä¾‹å¦‚ `PyramidPoolAgg`ã€`FocusFeature`ã€`SDFM` ç­‰ï¼Œè¿™äº›æ¨¡å—ç”¨äºç‰¹å®šçš„ä»»åŠ¡ï¼Œå¦‚ç‰¹å¾èåˆã€ä¸Šä¸‹æ–‡ä¿¡æ¯æå–ç­‰ã€‚

4. **åŠ¨æ€å·ç§¯å’Œè‡ªé€‚åº”å·ç§¯**ï¼šæ–‡ä»¶ä¸­å®ç°äº†åŠ¨æ€å·ç§¯ï¼ˆå¦‚ `DynamicConv` å’Œ `DynamicConv_Single`ï¼‰ï¼Œè¿™äº›å·ç§¯å±‚å¯ä»¥æ ¹æ®è¾“å…¥çš„ç‰¹å¾åŠ¨æ€è°ƒæ•´å…¶å‚æ•°ï¼Œä»¥æé«˜æ¨¡å‹çš„çµæ´»æ€§å’Œé€‚åº”æ€§ã€‚

5. **èåˆæ¨¡å—**ï¼šå®ç°äº†ä¸€äº›èåˆæ¨¡å—ï¼ˆå¦‚ `DynamicInterpolationFusion` å’Œ `FeaturePyramidSharedConv`ï¼‰ï¼Œè¿™äº›æ¨¡å—ç”¨äºå°†æ¥è‡ªä¸åŒå±‚çš„ç‰¹å¾è¿›è¡Œèåˆï¼Œä»¥å¢å¼ºæ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚

6. **è‡ªé€‚åº”æ¨¡å—**ï¼šå¦‚ `AdaptiveDilatedConv` å’Œ `SEAttention`ï¼Œè¿™äº›æ¨¡å—ç”¨äºåœ¨å·ç§¯æ“ä½œä¸­å¼•å…¥è‡ªé€‚åº”æœºåˆ¶ï¼Œä»¥ä¾¿æ›´å¥½åœ°æ•æ‰ç‰¹å¾ã€‚

7. **ç‰¹å®šç½‘ç»œç»“æ„**ï¼šæ–‡ä»¶ä¸­è¿˜å®ç°äº†ä¸€äº›ç‰¹å®šçš„ç½‘ç»œç»“æ„ï¼Œå¦‚ `CSPStage`ã€`C3k2` ç­‰ï¼Œè¿™äº›ç»“æ„é€šå¸¸ç”¨äºå®ç°æ›´å¤æ‚çš„ç½‘ç»œæ¨¡å‹ï¼Œå¦‚ YOLO ç³»åˆ—æ¨¡å‹ã€‚

æœ€åï¼Œæ–‡ä»¶ä¸­è¿˜åŒ…å«äº†ä¸€äº›è¾…åŠ©å‡½æ•°å’Œç±»ï¼Œç”¨äºåˆå§‹åŒ–æƒé‡ã€å¤„ç†è¾“å…¥æ•°æ®ç­‰ã€‚è¿™äº›å‡½æ•°å’Œç±»ä¸ºæ„å»ºå’Œè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹æä¾›äº†å¿…è¦çš„æ”¯æŒã€‚

æ€»ä½“è€Œè¨€ï¼Œ`block.py` æ–‡ä»¶æ˜¯ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„æ¨¡å—ï¼Œæä¾›äº†å¤šç§æ„å»ºæ·±åº¦å­¦ä¹ æ¨¡å‹æ‰€éœ€çš„ç»„ä»¶ï¼Œé€‚ç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„å®ç°ã€‚

#### 10.3 SwinTransformer.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„ä»£ç ï¼Œä¿ç•™äº†æ ¸å¿ƒéƒ¨åˆ†ï¼š

```python
import torch
import torch.nn as nn
import torch.nn.functional as F
import numpy as np
from timm.models.layers import DropPath, to_2tuple, trunc_normal_

class Mlp(nn.Module):
    """ å¤šå±‚æ„ŸçŸ¥æœº (MLP) æ¨¡å—ã€‚ """

    def __init__(self, in_features, hidden_features=None, out_features=None, act_layer=nn.GELU, drop=0.):
        super().__init__()
        out_features = out_features or in_features  # è¾“å‡ºç‰¹å¾æ•°
        hidden_features = hidden_features or in_features  # éšè—å±‚ç‰¹å¾æ•°
        self.fc1 = nn.Linear(in_features, hidden_features)  # ç¬¬ä¸€å±‚çº¿æ€§å˜æ¢
        self.act = act_layer()  # æ¿€æ´»å‡½æ•°
        self.fc2 = nn.Linear(hidden_features, out_features)  # ç¬¬äºŒå±‚çº¿æ€§å˜æ¢
        self.drop = nn.Dropout(drop)  # Dropoutå±‚

    def forward(self, x):
        """ å‰å‘ä¼ æ’­å‡½æ•°ã€‚ """
        x = self.fc1(x)  # çº¿æ€§å˜æ¢
        x = self.act(x)  # æ¿€æ´»
        x = self.drop(x)  # Dropout
        x = self.fc2(x)  # çº¿æ€§å˜æ¢
        x = self.drop(x)  # Dropout
        return x


class WindowAttention(nn.Module):
    """ çª—å£æ³¨æ„åŠ›æœºåˆ¶æ¨¡å—ã€‚ """

    def __init__(self, dim, window_size, num_heads, qkv_bias=True, attn_drop=0., proj_drop=0.):
        super().__init__()
        self.dim = dim
        self.window_size = window_size  # çª—å£å¤§å°
        self.num_heads = num_heads  # æ³¨æ„åŠ›å¤´æ•°
        head_dim = dim // num_heads  # æ¯ä¸ªå¤´çš„ç»´åº¦
        self.scale = head_dim ** -0.5  # ç¼©æ”¾å› å­

        # å®šä¹‰ç›¸å¯¹ä½ç½®åç½®å‚æ•°
        self.relative_position_bias_table = nn.Parameter(
            torch.zeros((2 * window_size[0] - 1) * (2 * window_size[1] - 1), num_heads))

        # è®¡ç®—ç›¸å¯¹ä½ç½®ç´¢å¼•
        coords_h = torch.arange(self.window_size[0])
        coords_w = torch.arange(self.window_size[1])
        coords = torch.stack(torch.meshgrid([coords_h, coords_w]))  # ç”Ÿæˆåæ ‡ç½‘æ ¼
        coords_flatten = torch.flatten(coords, 1)  # å±•å¹³åæ ‡
        relative_coords = coords_flatten[:, :, None] - coords_flatten[:, None, :]  # è®¡ç®—ç›¸å¯¹åæ ‡
        relative_coords = relative_coords.permute(1, 2, 0).contiguous()  # é‡æ–°æ’åˆ—
        relative_coords[:, :, 0] += self.window_size[0] - 1  # åç§»
        relative_coords[:, :, 1] += self.window_size[1] - 1
        relative_coords[:, :, 0] *= 2 * self.window_size[1] - 1
        self.relative_position_index = relative_coords.sum(-1)  # è®¡ç®—ç›¸å¯¹ä½ç½®ç´¢å¼•

        self.qkv = nn.Linear(dim, dim * 3, bias=qkv_bias)  # çº¿æ€§å˜æ¢ç”ŸæˆQ, K, V
        self.attn_drop = nn.Dropout(attn_drop)  # æ³¨æ„åŠ›Dropout
        self.proj = nn.Linear(dim, dim)  # è¾“å‡ºçº¿æ€§å˜æ¢
        self.proj_drop = nn.Dropout(proj_drop)  # è¾“å‡ºDropout
        trunc_normal_(self.relative_position_bias_table, std=.02)  # åˆå§‹åŒ–ç›¸å¯¹ä½ç½®åç½®
        self.softmax = nn.Softmax(dim=-1)  # Softmaxå±‚

    def forward(self, x, mask=None):
        """ å‰å‘ä¼ æ’­å‡½æ•°ã€‚ """
        B_, N, C = x.shape  # è·å–è¾“å…¥å½¢çŠ¶
        qkv = self.qkv(x).reshape(B_, N, 3, self.num_heads, C // self.num_heads).permute(2, 0, 3, 1, 4)
        q, k, v = qkv[0], qkv[1], qkv[2]  # åˆ†ç¦»Q, K, V

        q = q * self.scale  # ç¼©æ”¾Q
        attn = (q @ k.transpose(-2, -1))  # è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°

        # æ·»åŠ ç›¸å¯¹ä½ç½®åç½®
        relative_position_bias = self.relative_position_bias_table[self.relative_position_index.view(-1)].view(
            self.window_size[0] * self.window_size[1], self.window_size[0] * self.window_size[1], -1)
        relative_position_bias = relative_position_bias.permute(2, 0, 1).contiguous()
        attn = attn + relative_position_bias.unsqueeze(0)

        attn = self.softmax(attn)  # åº”ç”¨Softmax
        attn = self.attn_drop(attn)  # æ³¨æ„åŠ›Dropout

        x = (attn @ v).transpose(1, 2).reshape(B_, N, C)  # è®¡ç®—è¾“å‡º
        x = self.proj(x)  # è¾“å‡ºçº¿æ€§å˜æ¢
        x = self.proj_drop(x)  # è¾“å‡ºDropout
        return x


class SwinTransformer(nn.Module):
    """ Swin Transformer ä¸»ä½“ã€‚ """

    def __init__(self, patch_size=4, embed_dim=96, depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24]):
        super().__init__()
        self.patch_embed = PatchEmbed(patch_size=patch_size, in_chans=3, embed_dim=embed_dim)  # å›¾åƒåˆ†å—
        self.layers = nn.ModuleList()  # å­˜å‚¨æ¯ä¸€å±‚

        # æ„å»ºæ¯ä¸€å±‚
        for i_layer in range(len(depths)):
            layer = BasicLayer(
                dim=int(embed_dim * 2 ** i_layer),
                depth=depths[i_layer],
                num_heads=num_heads[i_layer],
                window_size=7,
                mlp_ratio=4.)
            self.layers.append(layer)

    def forward(self, x):
        """ å‰å‘ä¼ æ’­å‡½æ•°ã€‚ """
        x = self.patch_embed(x)  # å›¾åƒåˆ†å—
        outs = []
        for layer in self.layers:
            x = layer(x)  # é€šè¿‡æ¯ä¸€å±‚
            outs.append(x)  # æ”¶é›†è¾“å‡º
        return outs


def SwinTransformer_Tiny(weights=''):
    """ åˆ›å»ºä¸€ä¸ªå°å‹çš„Swin Transformeræ¨¡å‹ã€‚ """
    model = SwinTransformer(depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24])
    if weights:
        model.load_state_dict(torch.load(weights)['model'])  # åŠ è½½æƒé‡
    return model
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **Mlpç±»**ï¼šå®ç°äº†ä¸€ä¸ªç®€å•çš„å¤šå±‚æ„ŸçŸ¥æœºï¼ŒåŒ…æ‹¬ä¸¤ä¸ªçº¿æ€§å±‚å’Œä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼Œæ”¯æŒDropoutã€‚
2. **WindowAttentionç±»**ï¼šå®ç°äº†çª—å£æ³¨æ„åŠ›æœºåˆ¶ï¼Œè®¡ç®—Qã€Kã€Vï¼Œå¹¶æ·»åŠ ç›¸å¯¹ä½ç½®åç½®ã€‚
3. **SwinTransformerç±»**ï¼šæ„å»ºäº†Swin Transformerçš„ä¸»è¦ç»“æ„ï¼ŒåŒ…æ‹¬å›¾åƒåˆ†å—å’Œå¤šä¸ªå±‚çš„å †å ã€‚
4. **SwinTransformer_Tinyå‡½æ•°**ï¼šåˆ›å»ºä¸€ä¸ªå°å‹çš„Swin Transformeræ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

æ­¤ä»£ç æ˜¯Swin Transformerçš„æ ¸å¿ƒå®ç°ï¼ŒåŒ…å«äº†æ¨¡å‹çš„åŸºæœ¬ç»“æ„å’Œæ³¨æ„åŠ›æœºåˆ¶ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®ç°äº†Swin Transformeræ¨¡å‹ï¼Œä¸»è¦ç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚Swin Transformeræ˜¯ä¸€ç§åˆ†å±‚çš„è§†è§‰Transformerï¼Œé‡‡ç”¨äº†çª—å£æ³¨æ„åŠ›æœºåˆ¶ï¼Œé€šè¿‡åœ¨ä¸åŒå±‚æ¬¡ä¸Šå¤„ç†å›¾åƒå—æ¥æé«˜æ•ˆç‡å’Œæ•ˆæœã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬PyTorchå’Œä¸€äº›è‡ªå®šä¹‰çš„æ¨¡å—ã€‚æ¥ç€å®šä¹‰äº†å¤šä¸ªç±»å’Œå‡½æ•°ã€‚

`Mlp`ç±»å®ç°äº†ä¸€ä¸ªå¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼ŒåŒ…å«ä¸¤ä¸ªçº¿æ€§å±‚å’Œä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼ˆé»˜è®¤ä¸ºGELUï¼‰ï¼Œå¹¶åœ¨æ¯ä¸ªçº¿æ€§å±‚åé¢åŠ ä¸Šäº†Dropoutå±‚ï¼Œä»¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚

`window_partition`å’Œ`window_reverse`å‡½æ•°ç”¨äºå°†è¾“å…¥ç‰¹å¾å›¾åˆ†å‰²æˆçª—å£ï¼Œä»¥åŠå°†çª—å£åˆå¹¶å›ç‰¹å¾å›¾ã€‚çª—å£çš„å¤§å°ç”±å‚æ•°`window_size`æŒ‡å®šã€‚

`WindowAttention`ç±»å®ç°äº†åŸºäºçª—å£çš„å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆW-MSAï¼‰ï¼Œæ”¯æŒç›¸å¯¹ä½ç½®åç½®ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°å®šä¹‰äº†è¾“å…¥é€šé“æ•°ã€çª—å£å¤§å°ã€æ³¨æ„åŠ›å¤´æ•°ç­‰å‚æ•°ï¼Œå¹¶åˆå§‹åŒ–äº†ç›¸å¯¹ä½ç½®åç½®è¡¨ã€‚`forward`æ–¹æ³•è®¡ç®—è¾“å…¥ç‰¹å¾çš„æ³¨æ„åŠ›æƒé‡ï¼Œå¹¶åº”ç”¨äºè¾“å…¥ç‰¹å¾ã€‚

`SwinTransformerBlock`ç±»å®ç°äº†Swin Transformerçš„åŸºæœ¬å—ï¼ŒåŒ…å«å½’ä¸€åŒ–å±‚ã€çª—å£æ³¨æ„åŠ›å±‚å’ŒMLPã€‚è¯¥ç±»æ”¯æŒå¾ªç¯ç§»ä½ï¼Œä»¥å®ç°Shifted Window Attentionï¼ˆSW-MSAï¼‰ã€‚`forward`æ–¹æ³•å¤„ç†è¾“å…¥ç‰¹å¾ï¼Œè¿›è¡Œå½’ä¸€åŒ–ã€çª—å£åˆ†å‰²ã€æ³¨æ„åŠ›è®¡ç®—å’Œç‰¹å¾åˆå¹¶ã€‚

`PatchMerging`ç±»ç”¨äºå°†ç‰¹å¾å›¾çš„å—åˆå¹¶ï¼Œä»¥å‡å°‘ç‰¹å¾å›¾çš„ç©ºé—´ç»´åº¦ã€‚å®ƒé€šè¿‡çº¿æ€§å±‚å°†4ä¸ªè¾“å…¥é€šé“åˆå¹¶ä¸º2ä¸ªè¾“å‡ºé€šé“ï¼Œå¹¶åœ¨åˆå¹¶å‰è¿›è¡Œå½’ä¸€åŒ–ã€‚

`BasicLayer`ç±»è¡¨ç¤ºSwin Transformerçš„ä¸€ä¸ªåŸºæœ¬å±‚ï¼ŒåŒ…å«å¤šä¸ªSwin Transformerå—ï¼Œå¹¶åœ¨å¿…è¦æ—¶è¿›è¡Œä¸‹é‡‡æ ·ã€‚å®ƒè¿˜è®¡ç®—SW-MSAçš„æ³¨æ„åŠ›æ©ç ã€‚

`PatchEmbed`ç±»å°†è¾“å…¥å›¾åƒåˆ†å‰²æˆä¸é‡å çš„å—ï¼Œå¹¶é€šè¿‡å·ç§¯å±‚è¿›è¡ŒåµŒå…¥ã€‚å®ƒè¿˜æ”¯æŒå¯¹åµŒå…¥åçš„ç‰¹å¾è¿›è¡Œå½’ä¸€åŒ–ã€‚

`SwinTransformer`ç±»æ˜¯æ•´ä¸ªæ¨¡å‹çš„ä¸»ç±»ï¼Œè´Ÿè´£æ„å»ºæ¨¡å‹çš„å„ä¸ªå±‚æ¬¡ï¼ŒåŒ…æ‹¬å›¾åƒå—åµŒå…¥ã€ç»å¯¹ä½ç½®åµŒå…¥ã€å¤šä¸ªåŸºæœ¬å±‚å’Œè¾“å‡ºå±‚ã€‚å®ƒçš„`forward`æ–¹æ³•å¤„ç†è¾“å…¥å›¾åƒï¼Œç”Ÿæˆå¤šä¸ªè¾“å‡ºç‰¹å¾å›¾ã€‚

æœ€åï¼Œ`update_weight`å‡½æ•°ç”¨äºæ›´æ–°æ¨¡å‹çš„æƒé‡ï¼Œä»ç»™å®šçš„æƒé‡å­—å…¸ä¸­åŠ è½½åŒ¹é…çš„æƒé‡ã€‚`SwinTransformer_Tiny`å‡½æ•°åˆ›å»ºä¸€ä¸ªSwin Transformeræ¨¡å‹å®ä¾‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº†Swin Transformerçš„æ ¸å¿ƒç»„ä»¶å’Œç»“æ„ï¼Œé€‚ç”¨äºå›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ç­‰è§†è§‰ä»»åŠ¡ã€‚

#### 10.4 RFAConv.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import torch
import torch.nn as nn
from einops import rearrange

class RFAConv(nn.Module):
    def __init__(self, in_channel, out_channel, kernel_size, stride=1):
        super().__init__()
        self.kernel_size = kernel_size

        # ç”Ÿæˆæƒé‡çš„å·ç§¯æ¨¡å—
        self.get_weight = nn.Sequential(
            nn.AvgPool2d(kernel_size=kernel_size, padding=kernel_size // 2, stride=stride),
            nn.Conv2d(in_channel, in_channel * (kernel_size ** 2), kernel_size=1, groups=in_channel, bias=False)
        )
        
        # ç”Ÿæˆç‰¹å¾çš„å·ç§¯æ¨¡å—
        self.generate_feature = nn.Sequential(
            nn.Conv2d(in_channel, in_channel * (kernel_size ** 2), kernel_size=kernel_size, padding=kernel_size // 2, stride=stride, groups=in_channel, bias=False),
            nn.BatchNorm2d(in_channel * (kernel_size ** 2)),
            nn.ReLU()
        )
        
        # æœ€ç»ˆçš„å·ç§¯å±‚
        self.conv = nn.Conv2d(in_channel, out_channel, kernel_size=kernel_size, stride=kernel_size)

    def forward(self, x):
        b, c = x.shape[0:2]  # è·å–è¾“å…¥çš„æ‰¹æ¬¡å¤§å°å’Œé€šé“æ•°
        weight = self.get_weight(x)  # è®¡ç®—æƒé‡
        h, w = weight.shape[2:]  # è·å–ç‰¹å¾å›¾çš„é«˜å’Œå®½
        
        # å¯¹æƒé‡è¿›è¡Œsoftmaxå½’ä¸€åŒ–
        weighted = weight.view(b, c, self.kernel_size ** 2, h, w).softmax(2)  # b c*kernel**2, h, w
        
        # ç”Ÿæˆç‰¹å¾å¹¶è°ƒæ•´å½¢çŠ¶
        feature = self.generate_feature(x).view(b, c, self.kernel_size ** 2, h, w)  # b c*kernel**2, h, w
        
        # åŠ æƒç‰¹å¾
        weighted_data = feature * weighted
        
        # é‡æ’ç‰¹å¾æ•°æ®ä»¥é€‚åº”å·ç§¯å±‚çš„è¾“å…¥
        conv_data = rearrange(weighted_data, 'b c (n1 n2) h w -> b c (h n1) (w n2)', n1=self.kernel_size, n2=self.kernel_size)
        
        return self.conv(conv_data)  # è¿”å›å·ç§¯ç»“æœ


class SE(nn.Module):
    def __init__(self, in_channel, ratio=16):
        super(SE, self).__init__()
        self.gap = nn.AdaptiveAvgPool2d((1, 1))  # å…¨å±€å¹³å‡æ± åŒ–
        self.fc = nn.Sequential(
            nn.Linear(in_channel, ratio, bias=False),  # ä» c -> c/r
            nn.ReLU(),
            nn.Linear(ratio, in_channel, bias=False),  # ä» c/r -> c
            nn.Sigmoid()
        )

    def forward(self, x):
        b, c = x.shape[0:2]  # è·å–è¾“å…¥çš„æ‰¹æ¬¡å¤§å°å’Œé€šé“æ•°
        y = self.gap(x).view(b, c)  # è¿›è¡Œå…¨å±€å¹³å‡æ± åŒ–å¹¶è°ƒæ•´å½¢çŠ¶
        y = self.fc(y).view(b, c, 1, 1)  # é€šè¿‡å…¨è¿æ¥å±‚
        return y  # è¿”å›é€šé“æ³¨æ„åŠ›


class RFCBAMConv(nn.Module):
    def __init__(self, in_channel, out_channel, kernel_size=3, stride=1):
        super().__init__()
        self.kernel_size = kernel_size
        
        # ç”Ÿæˆç‰¹å¾çš„å·ç§¯æ¨¡å—
        self.generate = nn.Sequential(
            nn.Conv2d(in_channel, in_channel * (kernel_size ** 2), kernel_size, padding=kernel_size // 2, stride=stride, groups=in_channel, bias=False),
            nn.BatchNorm2d(in_channel * (kernel_size ** 2)),
            nn.ReLU()
        )
        
        # è®¡ç®—æƒé‡çš„å·ç§¯æ¨¡å—
        self.get_weight = nn.Sequential(nn.Conv2d(2, 1, kernel_size=3, padding=1, bias=False), nn.Sigmoid())
        self.se = SE(in_channel)  # é€šé“æ³¨æ„åŠ›æ¨¡å—

        # æœ€ç»ˆçš„å·ç§¯å±‚
        self.conv = nn.Conv2d(in_channel, out_channel, kernel_size=kernel_size, stride=kernel_size)

    def forward(self, x):
        b, c = x.shape[0:2]  # è·å–è¾“å…¥çš„æ‰¹æ¬¡å¤§å°å’Œé€šé“æ•°
        channel_attention = self.se(x)  # è®¡ç®—é€šé“æ³¨æ„åŠ›
        generate_feature = self.generate(x)  # ç”Ÿæˆç‰¹å¾

        h, w = generate_feature.shape[2:]  # è·å–ç‰¹å¾å›¾çš„é«˜å’Œå®½
        generate_feature = generate_feature.view(b, c, self.kernel_size ** 2, h, w)  # è°ƒæ•´å½¢çŠ¶
        
        # é‡æ’ç‰¹å¾æ•°æ®
        generate_feature = rearrange(generate_feature, 'b c (n1 n2) h w -> b c (h n1) (w n2)', n1=self.kernel_size, n2=self.kernel_size)
        
        # åŠ æƒç‰¹å¾
        unfold_feature = generate_feature * channel_attention
        
        # è®¡ç®—æœ€å¤§å€¼å’Œå‡å€¼ç‰¹å¾
        max_feature, _ = torch.max(generate_feature, dim=1, keepdim=True)
        mean_feature = torch.mean(generate_feature, dim=1, keepdim=True)
        
        # è®¡ç®—æ¥æ”¶åœºæ³¨æ„åŠ›
        receptive_field_attention = self.get_weight(torch.cat((max_feature, mean_feature), dim=1))
        
        # è¿”å›å·ç§¯ç»“æœ
        return self.conv(unfold_feature * receptive_field_attention)  # è¿”å›å·ç§¯ç»“æœ
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **RFAConv**ï¼šè¯¥ç±»å®ç°äº†ä¸€ç§å·ç§¯æ“ä½œï¼Œç»“åˆäº†æƒé‡ç”Ÿæˆå’Œç‰¹å¾ç”Ÿæˆã€‚å®ƒé€šè¿‡å¯¹è¾“å…¥ç‰¹å¾è¿›è¡ŒåŠ æƒï¼Œç”Ÿæˆæ–°çš„ç‰¹å¾å›¾ï¼Œå¹¶é€šè¿‡å·ç§¯å±‚è¾“å‡ºæœ€ç»ˆç»“æœã€‚
   
2. **SEï¼ˆSqueeze-and-Excitationï¼‰**ï¼šè¯¥ç±»å®ç°äº†é€šé“æ³¨æ„åŠ›æœºåˆ¶ï¼Œé€šè¿‡å…¨å±€å¹³å‡æ± åŒ–å’Œå…¨è¿æ¥å±‚æ¥è®¡ç®—æ¯ä¸ªé€šé“çš„é‡è¦æ€§ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„æƒé‡ã€‚

3. **RFCBAMConv**ï¼šè¯¥ç±»ç»“åˆäº†ç‰¹å¾ç”Ÿæˆã€é€šé“æ³¨æ„åŠ›å’Œæ¥æ”¶åœºæ³¨æ„åŠ›çš„æœºåˆ¶ï¼Œè¿›ä¸€æ­¥å¢å¼ºäº†å·ç§¯æ“ä½œçš„æ•ˆæœã€‚å®ƒé€šè¿‡æœ€å¤§æ± åŒ–å’Œå‡å€¼æ± åŒ–æ¥è®¡ç®—æ¥æ”¶åœºæ³¨æ„åŠ›ï¼Œå¹¶ä¸ç”Ÿæˆçš„ç‰¹å¾ç›¸ç»“åˆï¼Œæœ€ç»ˆé€šè¿‡å·ç§¯å±‚è¾“å‡ºç»“æœã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†å‡ ä¸ªç”¨äºå·ç§¯ç¥ç»ç½‘ç»œçš„æ¨¡å—ï¼Œä¸»è¦åŒ…æ‹¬RFAConvã€RFCBAMConvå’ŒRFCAConvã€‚æ–‡ä»¶ä¸­ä½¿ç”¨äº†PyTorchåº“ï¼Œå¹¶ä¸”ç»“åˆäº†ä¸€äº›è‡ªå®šä¹‰çš„æ¿€æ´»å‡½æ•°å’Œå·ç§¯æ“ä½œã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¼•å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬torchå’Œtorch.nnï¼Œä»¥åŠç”¨äºé‡æ’å¼ é‡çš„einopsåº“ã€‚æ¥ç€ï¼Œå®šä¹‰äº†ä¸¤ä¸ªè‡ªå®šä¹‰çš„æ¿€æ´»å‡½æ•°ï¼šh_sigmoidå’Œh_swishã€‚h_sigmoidæ˜¯ä¸€ä¸ªæ”¹è¿›çš„sigmoidå‡½æ•°ï¼Œä½¿ç”¨ReLU6æ¥é™åˆ¶è¾“å‡ºèŒƒå›´ï¼›h_swishåˆ™æ˜¯å°†è¾“å…¥ä¸h_sigmoidçš„è¾“å‡ºç›¸ä¹˜ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„æ¿€æ´»å‡½æ•°ã€‚

RFAConvç±»æ˜¯ä¸€ä¸ªå·ç§¯æ¨¡å—ï¼Œåˆå§‹åŒ–æ—¶æ¥æ”¶è¾“å…¥é€šé“æ•°ã€è¾“å‡ºé€šé“æ•°ã€å·ç§¯æ ¸å¤§å°å’Œæ­¥å¹…ã€‚å®ƒåŒ…å«ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼šä¸€ä¸ªç”¨äºç”Ÿæˆæƒé‡çš„å·ç§¯å±‚å’Œä¸€ä¸ªç”¨äºç”Ÿæˆç‰¹å¾çš„å·ç§¯å±‚ã€‚æƒé‡é€šè¿‡å¯¹è¾“å…¥è¿›è¡Œå¹³å‡æ± åŒ–å’Œå·ç§¯å¾—åˆ°ï¼Œç‰¹å¾åˆ™é€šè¿‡å·ç§¯ã€æ‰¹å½’ä¸€åŒ–å’ŒReLUæ¿€æ´»å¾—åˆ°ã€‚åœ¨å‰å‘ä¼ æ’­ä¸­ï¼Œé¦–å…ˆè®¡ç®—æƒé‡ï¼Œç„¶åå¯¹ç‰¹å¾è¿›è¡Œå¤„ç†ï¼Œæœ€åé€šè¿‡é‡æ’å’Œå·ç§¯å¾—åˆ°è¾“å‡ºã€‚

RFCBAMConvç±»åœ¨RFAConvçš„åŸºç¡€ä¸Šå¢åŠ äº†é€šé“æ³¨æ„åŠ›æœºåˆ¶ã€‚å®ƒé€šè¿‡SEï¼ˆSqueeze-and-Excitationï¼‰æ¨¡å—æ¥ç”Ÿæˆé€šé“æ³¨æ„åŠ›ï¼Œå¹¶ç»“åˆæœ€å¤§æ± åŒ–å’Œå¹³å‡æ± åŒ–æ¥è·å–ç‰¹å¾çš„å…¨å±€ä¿¡æ¯ã€‚ç”Ÿæˆçš„ç‰¹å¾ç»è¿‡é‡æ’åä¸é€šé“æ³¨æ„åŠ›ç›¸ä¹˜ï¼Œæœ€åé€šè¿‡å·ç§¯å¾—åˆ°è¾“å‡ºã€‚

RFCAConvç±»åˆ™è¿›ä¸€æ­¥æ‰©å±•äº†åŠŸèƒ½ï¼Œç»“åˆäº†ç©ºé—´æ³¨æ„åŠ›æœºåˆ¶ã€‚å®ƒåœ¨ç”Ÿæˆç‰¹å¾åï¼Œåˆ†åˆ«å¯¹ç‰¹å¾åœ¨é«˜åº¦å’Œå®½åº¦æ–¹å‘è¿›è¡Œè‡ªé€‚åº”å¹³å‡æ± åŒ–ï¼Œç”Ÿæˆä¸¤ä¸ªç‰¹å¾å›¾ã€‚ç„¶åå°†è¿™ä¸¤ä¸ªç‰¹å¾å›¾æ‹¼æ¥ï¼Œç»è¿‡ä¸€ç³»åˆ—å·ç§¯å’Œæ¿€æ´»æ“ä½œåï¼Œå¾—åˆ°ç©ºé—´æ³¨æ„åŠ›ã€‚æœ€ç»ˆï¼Œç”Ÿæˆçš„ç‰¹å¾ä¸ç©ºé—´æ³¨æ„åŠ›ç›¸ä¹˜ï¼Œå¹¶é€šè¿‡å·ç§¯å¾—åˆ°æœ€ç»ˆè¾“å‡ºã€‚

æ•´ä¸ªæ–‡ä»¶å®ç°äº†åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„å·ç§¯æ“ä½œï¼Œæ—¨åœ¨æå‡ç‰¹å¾æå–çš„èƒ½åŠ›ï¼Œä½¿å¾—ç½‘ç»œåœ¨å¤„ç†å›¾åƒæ—¶èƒ½å¤Ÿæ›´åŠ å…³æ³¨é‡è¦çš„åŒºåŸŸå’Œé€šé“ã€‚è¿™äº›æ¨¡å—å¯ä»¥è¢«é›†æˆåˆ°æ›´å¤§çš„ç¥ç»ç½‘ç»œä¸­ï¼Œä»¥æé«˜æ€§èƒ½ã€‚

### 11.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+200+ç§å…¨å¥—åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/Z5yamZ1w](https://mbd.pub/o/bread/Z5yamZ1w)